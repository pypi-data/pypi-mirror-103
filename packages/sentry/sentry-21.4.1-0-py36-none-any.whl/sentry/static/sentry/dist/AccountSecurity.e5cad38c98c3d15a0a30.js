(self.webpackChunk=self.webpackChunk||[]).push([["AccountSecurity"],{"./app/data/forms/accountPassword.tsx":(e,t,n)=>{"use strict";n.r(t),n.d(t,{route:()=>o,default:()=>r});var s=function(e){return!e.user.isManaged},o="/settings/account/security/";const r=[{title:"Password",fields:[{name:"password",type:"secret",autoComplete:"current-password",label:"Current Password",placeholder:"",help:"Your current password",visible:s,required:!0},{name:"passwordNew",type:"secret",autoComplete:"new-password",label:"New Password",placeholder:"",help:"",required:!0,visible:s,validate:function(e){var t=e.id,n=e.form;return n[t]!==n.passwordVerify?[[t,""]]:[]}},{name:"passwordVerify",type:"secret",autoComplete:"new-password",label:"Verify New Password",placeholder:"",help:"Verify your new password",required:!0,visible:s,validate:function(e){var t=e.id,n=e.form;return n.passwordNew&&n.passwordNew!==n[t]?[[t,"Passwords do not match"]]:[]}}]}]},"./app/utils/recreateRoute.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var s=n("../node_modules/lodash/findLastIndex.js"),o=n.n(s),r=n("./app/utils/replaceRouterParams.tsx");function a(e,t){var n,s,a,i,l=t.routes,u=t.params,c=t.location,d=t.stepBack,p=l.map((function(e){return e.path||""}));"string"!=typeof e?(i=l.indexOf(e)+1,a=o()(p.slice(0,i),(function(e){return"/"===e[0]}))):a=o()(p,(function(e){return"/"===e[0]}));var m=p.slice(a,i);void 0!==d&&(m=m.slice(0,d));var f=null!==(n=null==c?void 0:c.search)&&void 0!==n?n:"",Z=null!==(s=null==c?void 0:c.hash)&&void 0!==s?s:"",h="".concat(m.join("")).concat("string"!=typeof e?"":e).concat(f).concat(Z);return(0,r.Z)(h,u)}},"./app/views/settings/account/accountSecurity/index.tsx":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>W});var s=n("../node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),o=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),r=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),a=n("../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),i=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),l=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),u=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),c=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),d=n("../node_modules/@emotion/styled-base/dist/styled-base.browser.esm.js"),p=n("../node_modules/@babel/runtime/regenerator/index.js"),m=n.n(p),f=(n("../node_modules/react/index.js"),n("./app/actionCreators/indicator.tsx")),Z=n("./app/components/button.tsx"),h=n("./app/components/circleIndicator.tsx"),g=n("./app/components/links/listLink.tsx"),v=n("./app/components/navTabs.tsx"),w=n("./app/components/panels/index.tsx"),b=n("./app/components/tooltip.tsx"),y=n("./app/icons/index.tsx"),x=n("./app/locale.tsx"),S=n("./app/styles/space.tsx"),P=n("./app/utils/recreateRoute.tsx"),k=n("./app/views/asyncView.tsx"),q=n("./app/views/settings/account/accountSecurity/components/removeConfirm.tsx"),C=n("./app/components/alert.tsx"),j=n("./app/components/links/externalLink.tsx"),_=n("./app/utils/getPendingInvite.tsx"),A=n("../node_modules/@emotion/core/dist/core.browser.esm.js"),N=(0,d.Z)(C.Z,{target:"em89xh0",label:"StyledAlert"})("margin:",(0,S.Z)(3)," 0;");const z=function(){return(0,_.Z)()?(0,A.tZ)(N,{"data-test-id":"require-2fa",type:"error",icon:(0,A.tZ)(y.Gy,{size:"md"})},(0,x._N)("You have been invited to an organization that requires [link:two-factor authentication]. Setup two-factor authentication below to join your organization.",{link:(0,A.tZ)(j.Z,{href:"https://docs.sentry.io/accounts/require-2fa/"})})):null};var R=n("./app/data/forms/accountPassword.tsx"),T=n("./app/stores/configStore.tsx"),E=n("./app/views/settings/components/forms/form.tsx"),F=n("./app/views/settings/components/forms/jsonForm.tsx");function I(){var e=T.Z.get("user");return(0,A.tZ)(E.Z,{apiMethod:"PUT",apiEndpoint:"/users/me/password/",initialData:{},onSubmitSuccess:function(e,t){t.resetForm(),(0,f.S9)("Password has been changed")},onSubmitError:function(){(0,f.Iw)("Error changing password")},hideFooter:!0},(0,A.tZ)(F.Z,{forms:R.default,additionalFieldProps:{user:e},renderFooter:function(){return(0,A.tZ)(w.Lv,{justifyContent:"flex-end"},(0,A.tZ)(Z.ZP,{type:"submit",priority:"primary"},(0,x.t)("Change password")))},renderHeader:function(){return(0,A.tZ)(w.aU,{type:"info"},(0,x.t)("Changing your password will invalidate all logged in sessions."))}}))}I.displayName="PasswordForm";const B=I;var V=n("./app/views/settings/components/emptyMessage.tsx"),L=n("./app/views/settings/components/forms/field/index.tsx"),D=n("./app/views/settings/components/settingsPageHeader.tsx"),O=n("./app/views/settings/components/text/textBlock.tsx");var H=function(e){(0,i.Z)(p,e);var t,n,d=(t=p,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,s=(0,u.Z)(t);if(n){var o=(0,u.Z)(this).constructor;e=Reflect.construct(s,arguments,o)}else e=s.apply(this,arguments);return(0,l.Z)(this,e)});function p(){var e;(0,o.Z)(this,p);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e=d.call.apply(d,[this].concat(n)),(0,c.Z)((0,a.Z)(e),"handleSessionClose",(0,s.Z)(m().mark((function t(){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.api.requestPromise("/auth/",{method:"DELETE",data:{all:!0}});case 3:window.location.assign("/auth/login/"),t.next=10;break;case 6:throw t.prev=6,t.t0=t.catch(0),(0,f.Iw)((0,x.t)("There was a problem closing all sessions")),t.t0;case 10:case"end":return t.stop()}}),t,null,[[0,6]])})))),(0,c.Z)((0,a.Z)(e),"formatOrgSlugs",(function(){var t=e.props.orgsRequire2fa.map((function(e){return e.slug}));return[t.slice(0,-1).join(", "),t.slice(-1)[0]].join(t.length>1?" and ":"")})),e}return(0,r.Z)(p,[{key:"getTitle",value:function(){return(0,x.t)("Security")}},{key:"getEndpoints",value:function(){return[]}},{key:"renderBody",value:function(){var e=this,t=this.props,n=t.authenticators,s=t.countEnrolled,o=t.deleteDisabled,r=t.onDisable,a=!(null!=n&&n.length);return(0,A.tZ)("div",null,(0,A.tZ)(D.Z,{title:(0,x.t)("Security"),tabs:(0,A.tZ)(v.Z,{underlined:!0},(0,A.tZ)(g.Z,{to:(0,P.Z)("",this.props),index:!0},(0,x.t)("Settings")),(0,A.tZ)(g.Z,{to:(0,P.Z)("session-history/",this.props)},(0,x.t)("Session History")))}),!a&&0===s&&(0,A.tZ)(z,null),(0,A.tZ)(B,null),(0,A.tZ)(w.s_,null,(0,A.tZ)(w.V9,null,(0,x.t)("Sessions")),(0,A.tZ)(w.N,null,(0,A.tZ)(L.Z,{alignRight:!0,flexibleControlStateSize:!0,label:(0,x.t)("Sign out of all devices"),help:(0,x.t)("Signing out of all devices will sign you out of this device as well.")},(0,A.tZ)(Z.ZP,{"data-test-id":"signoutAll",onClick:this.handleSessionClose},(0,x.t)("Sign out of all devices"))))),(0,A.tZ)(w.s_,null,(0,A.tZ)(w.V9,null,(0,x.t)("Two-Factor Authentication")),a&&(0,A.tZ)(V.Z,null,(0,x.t)("No available authenticators to add")),(0,A.tZ)(w.N,null,!a&&(null==n?void 0:n.map((function(t){var n=t.id,s=t.authId,a=t.description,i=t.isBackupInterface,l=t.isEnrolled,u=t.configureButton,c=t.name;return(0,A.tZ)(G,{key:n},(0,A.tZ)(U,null,(0,A.tZ)(Y,null,(0,A.tZ)(K,{enabled:l}),(0,A.tZ)(M,null,c)),(0,A.tZ)(J,null,!i&&!l&&(0,A.tZ)(Z.ZP,{to:"/settings/account/security/mfa/".concat(n,"/enroll/"),size:"small",priority:"primary",className:"enroll-button"},(0,x.t)("Add")),l&&s&&(0,A.tZ)(Z.ZP,{to:"/settings/account/security/mfa/".concat(s,"/"),size:"small",className:"details-button"},u),!i&&l&&(0,A.tZ)(b.Z,{title:(0,x.t)("Two-factor authentication is required for organization(s): ".concat(e.formatOrgSlugs(),".")),disabled:!o},(0,A.tZ)(q.Z,{onConfirm:function(){return r(t)},disabled:o},(0,A.tZ)(Z.ZP,{size:"small",label:(0,x.t)("delete"),icon:(0,A.tZ)(y.Fz,null)})))),i&&!l?(0,x.t)("requires 2FA"):null),(0,A.tZ)(Q,null,a))}))))))}}]),p}(k.Z),M=(0,d.Z)("span",{target:"e7qdl2c0",label:"AuthenticatorName"})({name:"1x1uhd2",styles:"font-size:1.2em;"}),G=(0,d.Z)(w.Lv,{target:"e7qdl2c1",label:"AuthenticatorPanelItem"})({name:"cgq59l",styles:"flex-direction:column;"}),U=(0,d.Z)("div",{target:"e7qdl2c2",label:"AuthenticatorHeader"})({name:"14oqdsi",styles:"display:flex;flex:1;align-items:center;"}),Y=(0,d.Z)("div",{target:"e7qdl2c3",label:"AuthenticatorTitle"})({name:"1rr4qq7",styles:"flex:1;"}),J=(0,d.Z)("div",{target:"e7qdl2c4",label:"Actions"})("display:grid;grid-auto-flow:column;grid-gap:",(0,S.Z)(1),";"),K=(0,d.Z)(h.Z,{target:"e7qdl2c5",label:"AuthenticatorStatus"})("margin-right:",(0,S.Z)(1),";"),Q=(0,d.Z)(O.Z,{target:"e7qdl2c6",label:"Description"})("margin-top:",(0,S.Z)(2),";margin-bottom:0;");const W=H}}]);
//# sourceMappingURL=AccountSecurity.js.map