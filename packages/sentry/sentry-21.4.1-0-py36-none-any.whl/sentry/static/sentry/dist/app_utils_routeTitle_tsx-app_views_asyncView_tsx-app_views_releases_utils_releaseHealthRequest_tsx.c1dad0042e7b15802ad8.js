(self.webpackChunk=self.webpackChunk||[]).push([["app_utils_routeTitle_tsx-app_views_asyncView_tsx-app_views_releases_utils_releaseHealthRequest_tsx"],{"./app/utils/routeTitle.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});const r=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3?arguments[3]:void 0,s="".concat(e," - ").concat(t),o=r?"".concat(s," - ").concat(r):s;return n?"".concat(o," - Sentry"):o}},"./app/views/asyncView.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var r=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),s=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),u=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),i=(n("../node_modules/react/index.js"),n("../node_modules/react-document-title/index.js")),l=n.n(i),c=n("./app/components/asyncComponent.tsx"),d=n("../node_modules/@emotion/core/dist/core.browser.esm.js");var p=function(e){(0,o.Z)(c,e);var t,n,i=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,u.Z)(t);if(n){var s=(0,u.Z)(this).constructor;e=Reflect.construct(r,arguments,s)}else e=r.apply(this,arguments);return(0,a.Z)(this,e)});function c(){return(0,r.Z)(this,c),i.apply(this,arguments)}return(0,s.Z)(c,[{key:"getTitle",value:function(){return""}},{key:"render",value:function(){var e=this.getTitle();return(0,d.tZ)(l(),{title:"".concat(e?"".concat(e," - "):"","Sentry")},this.renderComponent())}}]),c}(c.Z);p.displayName="AsyncView"},"./app/views/releases/list/utils.tsx":(e,t,n)=>{"use strict";var r,s,o;n.d(t,{Y7:()=>r,zY:()=>s,L4:()=>o}),function(e){e.CRASH_FREE_USERS="crash_free_users",e.CRASH_FREE_SESSIONS="crash_free_sessions",e.USERS_24_HOURS="users_24h",e.SESSIONS="sessions",e.DATE="date"}(r||(r={})),function(e){e.USERS="users",e.SESSIONS="sessions"}(s||(s={})),function(e){e.ACTIVE="active",e.ARCHIVED="archived"}(o||(o={}))},"./app/views/releases/utils/index.tsx":(e,t,n)=>{"use strict";n.d(t,{G5:()=>c,Mf:()=>d,zB:()=>p,PS:()=>h,eY:()=>f,rF:()=>v,gs:()=>y});var r=n("../node_modules/lodash/round.js"),s=n.n(r),o=n("./app/locale.tsx"),a=n("./app/types/index.tsx"),u=n("./app/utils/tokenizeSearch.tsx"),i=n("./app/views/issueList/utils.tsx"),l=n("./app/views/releases/list/utils.tsx"),c=function(e){return s()(e,e>60?0:3)},d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:95,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;return s()(e,e>t?n:0)},p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:95,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;if(isNaN(e))return"â€•";if(e<1&&e>0)return"<1%";var r=d(e,t,n).toLocaleString();return"".concat(r,"%")},h=function(e,t,n){return{pathname:"/organizations/".concat(e,"/issues/"),query:{project:t,statsPeriod:void 0,start:void 0,end:void 0,query:(0,u.gZ)(new u.an(["firstRelease:".concat(n)])),sort:i.qh.FREQ}}},f=function(e,t,n){return{pathname:"/organizations/".concat(e,"/issues/"),query:{project:t,query:(0,u.gZ)(new u.an(["release:".concat(n),"error.unhandled:true"])),sort:i.qh.FREQ}}},v=function(e){return e.status===a.dE.Archived};function y(e,t){return e===l.zY.USERS?(0,o.tn)("user","users",t):(0,o.tn)("session","sessions",t)}},"./app/views/releases/utils/releaseHealthRequest.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>N});var r=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),s=n("../node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),o=n("../node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),a=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),u=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),i=n("../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),l=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),c=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),d=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),p=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),h=n("../node_modules/@babel/runtime/regenerator/index.js"),f=n.n(h),v=n("../node_modules/react/index.js"),y=n("../node_modules/lodash/isEqual.js"),m=n.n(y),g=n("../node_modules/lodash/omit.js"),b=n.n(g),j=n("../node_modules/lodash/pick.js"),C=n.n(j),P=n("../node_modules/moment/moment.js"),S=n.n(P),R=n("./app/actionCreators/indicator.tsx"),Z=n("./app/components/charts/utils.tsx"),_=n("./app/components/organizations/globalSelectionHeader/getParams.tsx"),x=n("./app/constants/globalSelectionHeader.tsx"),B=n("./app/locale.tsx"),w=n("./app/types/index.tsx"),T=n("./app/utils.tsx"),I=n("./app/utils/tokenizeSearch.tsx"),O=n("./app/utils/withApi.tsx"),k=n("./app/views/releases/list/utils.tsx"),E=n("./app/views/releases/utils/index.tsx");function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){(0,p.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function A(e){return b()(e,["api","organization","children","selection.datetime.utc","location"])}function z(e,t,n){var r;return null===(r=t.series[n])||void 0===r||r.forEach((function(t,n){var r;return e[n]=(null!==(r=e[n])&&void 0!==r?r:0)+t})),e}var D=function(e){(0,l.Z)(j,e);var t,n,h,v,y,g,b=(y=j,g=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,d.Z)(y);if(g){var n=(0,d.Z)(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return(0,c.Z)(this,e)});function j(){var e;(0,a.Z)(this,j);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e=b.call.apply(b,[this].concat(n)),(0,p.Z)((0,i.Z)(e),"state",{loading:!1,errored:!1,statusCountByReleaseInPeriod:null,totalCountByReleaseIn24h:null,totalCountByProjectIn24h:null,statusCountByProjectInPeriod:null}),(0,p.Z)((0,i.Z)(e),"fetchData",(0,o.Z)(f().mark((function t(){var n,r,o,a,u,i,l,c,d,p,h,v;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.props,r=n.api,o=n.healthStatsPeriod,r.clear(),e.setState({loading:!0,errored:!1,statusCountByReleaseInPeriod:null,totalCountByReleaseIn24h:null,totalCountByProjectIn24h:null}),a=[e.fetchStatusCountByReleaseInPeriod(),e.fetchTotalCountByReleaseIn24h(),e.fetchTotalCountByProjectIn24h()],o===w.$A.AUTO&&a.push(e.fetchStatusCountByProjectInPeriod()),t.prev=5,t.next=8,Promise.all(a);case 8:u=t.sent,i=(0,s.Z)(u,4),l=i[0],c=i[1],d=i[2],p=i[3],e.setState({loading:!1,statusCountByReleaseInPeriod:l,totalCountByReleaseIn24h:c,totalCountByProjectIn24h:d,statusCountByProjectInPeriod:p}),t.next=21;break;case 17:t.prev=17,t.t0=t.catch(5),(0,R.Iw)(null!==(h=null===(v=t.t0.responseJSON)||void 0===v?void 0:v.detail)&&void 0!==h?h:(0,B.t)("Error loading health data")),e.setState({loading:!1,errored:!0});case 21:case"end":return t.stop()}}),t,null,[[5,17]])})))),(0,p.Z)((0,i.Z)(e),"getHealthData",(function(){return{getCrashCount:e.getCrashCount,getCrashFreeRate:e.getCrashFreeRate,get24hCountByRelease:e.get24hCountByRelease,get24hCountByProject:e.get24hCountByProject,getTimeSeries:e.getTimeSeries,getAdoption:e.getAdoption}})),(0,p.Z)((0,i.Z)(e),"getCrashCount",(function(t,n,r){var s,o=e.state.statusCountByReleaseInPeriod,a=e.displayToField(r);return null==o||null===(s=o.groups.find((function(e){var r=e.by;return r.release===t&&r.project===n&&"crashed"===r["session.status"]})))||void 0===s?void 0:s.totals[a]})),(0,p.Z)((0,i.Z)(e),"getCrashFreeRate",(function(t,n,r){var s,o=e.state.statusCountByReleaseInPeriod,a=e.displayToField(r),u=null==o||null===(s=o.groups.filter((function(e){var r=e.by;return r.release===t&&r.project===n})))||void 0===s?void 0:s.reduce((function(e,t){return e+t.totals[a]}),0),i=e.getCrashCount(t,n,r);return(0,T.ri)(u)&&0!==u?(0,E.Mf)(100-(0,T.aQ)(null!=i?i:0,null!=u?u:0)):null})),(0,p.Z)((0,i.Z)(e),"get24hCountByRelease",(function(t,n,r){var s,o=e.state.totalCountByReleaseIn24h,a=e.displayToField(r);return null==o||null===(s=o.groups.filter((function(e){var r=e.by;return r.release===t&&r.project===n})))||void 0===s?void 0:s.reduce((function(e,t){return e+t.totals[a]}),0)})),(0,p.Z)((0,i.Z)(e),"get24hCountByProject",(function(t,n){var r,s=e.state.totalCountByProjectIn24h,o=e.displayToField(n);return null==s||null===(r=s.groups.filter((function(e){return e.by.project===t})))||void 0===r?void 0:r.reduce((function(e,t){return e+t.totals[o]}),0)})),(0,p.Z)((0,i.Z)(e),"getTimeSeries",(function(t,n,r){return e.props.healthStatsPeriod===w.$A.AUTO?e.getPeriodTimeSeries(t,n,r):e.get24hTimeSeries(t,n,r)})),(0,p.Z)((0,i.Z)(e),"get24hTimeSeries",(function(t,n,r){var s,o,a,u=e.state,i=u.totalCountByReleaseIn24h,l=u.totalCountByProjectIn24h,c=e.displayToField(r),d=null!==(s=null==l?void 0:l.intervals)&&void 0!==s?s:[],p=null==l||null===(o=l.groups.find((function(e){return e.by.project===n})))||void 0===o?void 0:o.series[c],h=null==i||null===(a=i.groups.find((function(e){var r=e.by;return r.project===n&&r.release===t})))||void 0===a?void 0:a.series[c];return[{seriesName:(0,B.t)("This Release"),data:null==d?void 0:d.map((function(e,t){var n;return{name:S()(e).valueOf(),value:null!==(n=null==h?void 0:h[t])&&void 0!==n?n:0}}))},{seriesName:(0,B.t)("Total Project"),data:null==d?void 0:d.map((function(e,t){var n;return{name:S()(e).valueOf(),value:null!==(n=null==p?void 0:p[t])&&void 0!==n?n:0}})),z:0}]})),(0,p.Z)((0,i.Z)(e),"getPeriodTimeSeries",(function(t,n,r){var s,o,a,u=e.state,i=u.statusCountByReleaseInPeriod,l=u.statusCountByProjectInPeriod,c=e.displayToField(r),d=null!==(s=null==l?void 0:l.intervals)&&void 0!==s?s:[],p=null==l||null===(o=l.groups.filter((function(e){return e.by.project===n})))||void 0===o?void 0:o.reduce((function(e,t){return z(e,t,c)}),[]),h=null==i||null===(a=i.groups.filter((function(e){var r=e.by;return r.project===n&&r.release===t})))||void 0===a?void 0:a.reduce((function(e,t){return z(e,t,c)}),[]);return[{seriesName:(0,B.t)("This Release"),data:null==d?void 0:d.map((function(e,t){var n;return{name:S()(e).valueOf(),value:null!==(n=null==h?void 0:h[t])&&void 0!==n?n:0}}))},{seriesName:(0,B.t)("Total Project"),data:null==d?void 0:d.map((function(e,t){var n;return{name:S()(e).valueOf(),value:null!==(n=null==p?void 0:p[t])&&void 0!==n?n:0}})),z:0}]})),(0,p.Z)((0,i.Z)(e),"getAdoption",(function(t,n,r){var s=e.get24hCountByRelease(t,n,r),o=e.get24hCountByProject(n,r);return(0,T.ri)(s)&&(0,T.ri)(o)?(0,T.aQ)(s,o):void 0})),e}return(0,u.Z)(j,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"componentDidUpdate",value:function(e){this.props.releasesReloading||m()(A(e),A(this.props))||this.fetchData()}},{key:"path",get:function(){var e=this.props.organization;return"/organizations/".concat(e.slug,"/sessions/")}},{key:"baseQueryParams",get:function(){var e,t,n=this.props,r=n.location,s=n.selection,o=n.defaultStatsPeriod,a=n.releases;return F({query:(0,I.gZ)(new I.an(a.reduce((function(e,t,n,r){return e.push('release:"'.concat(t,'"')),n<r.length-1&&e.push("OR"),e}),[]))),interval:(e=s.datetime,t=(0,Z.Nm)(e),t>=Z.$i?"1d":t>=Z.IZ?"6h":t>Z.w3?"4h":"1h")},(0,_.Q)(C()(r.query,Object.values(x.nF)),{defaultStatsPeriod:o}))}},{key:"fetchStatusCountByReleaseInPeriod",value:(v=(0,o.Z)(f().mark((function e(){var t,n,s,o,a=this;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.api,s=t.display,e.next=3,n.requestPromise(this.path,{query:F(F({},this.baseQueryParams),{},{field:(0,r.Z)(new Set([].concat((0,r.Z)(s.map((function(e){return a.displayToField(e)}))),["sum(session)"]))),groupBy:["project","release","session.status"]})});case 3:return o=e.sent,e.abrupt("return",o);case 5:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"fetchStatusCountByProjectInPeriod",value:(h=(0,o.Z)(f().mark((function e(){var t,n,s,o,a=this;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.api,s=t.display,e.next=3,n.requestPromise(this.path,{query:F(F({},this.baseQueryParams),{},{query:void 0,field:(0,r.Z)(new Set([].concat((0,r.Z)(s.map((function(e){return a.displayToField(e)}))),["sum(session)"]))),groupBy:["project","session.status"]})});case 3:return o=e.sent,e.abrupt("return",o);case 5:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"fetchTotalCountByReleaseIn24h",value:(n=(0,o.Z)(f().mark((function e(){var t,n,r,s,o=this;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.api,r=t.display,e.next=3,n.requestPromise(this.path,{query:F(F({},this.baseQueryParams),{},{field:r.map((function(e){return o.displayToField(e)})),groupBy:["project","release"],interval:"1h",statsPeriod:"24h"})});case 3:return s=e.sent,e.abrupt("return",s);case 5:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"fetchTotalCountByProjectIn24h",value:(t=(0,o.Z)(f().mark((function e(){var t,n,r,s,o=this;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,n=t.api,r=t.display,e.next=3,n.requestPromise(this.path,{query:F(F({},this.baseQueryParams),{},{query:void 0,field:r.map((function(e){return o.displayToField(e)})),groupBy:["project"],interval:"1h",statsPeriod:"24h"})});case 3:return s=e.sent,e.abrupt("return",s);case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"displayToField",value:function(e){switch(e){case k.zY.USERS:return"count_unique(user)";case k.zY.SESSIONS:default:return"sum(session)"}}},{key:"render",value:function(){var e=this.state,t=e.loading,n=e.errored;return(0,this.props.children)({isHealthLoading:t,errored:n,getHealthData:this.getHealthData()})}}]),j}(v.Component);D.displayName="ReleaseHealthRequest";const N=(0,O.Z)(D)}}]);
//# sourceMappingURL=app_utils_routeTitle_tsx-app_views_asyncView_tsx-app_views_releases_utils_releaseHealthRequest_tsx.js.map