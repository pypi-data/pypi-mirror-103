{"version":3,"sources":["webpack:///./app/components/inactivePlugins.tsx","webpack:///./app/components/pluginList.tsx","webpack:///./app/components/sentryDocumentTitle.tsx","webpack:///./app/views/settings/project/permissionAlert.tsx","webpack:///./app/views/settings/projectDataForwarding.tsx"],"names":["InactivePlugins","plugins","onEnablePlugin","length","t","Plugins","map","plugin","IntegrationButton","key","id","onClick","className","Label","StyledPluginIcon","pluginId","shortName","name","space","p","theme","fontSizeSmall","borderRadius","PluginIcon","PluginList","organization","project","pluginList","onDisablePlugin","handleDisablePlugin","disablePlugin","projectId","slug","orgId","filter","enabled","data","isHidden","enablePlugin","SentryDocumentTitle","title","orgSlug","projectSlug","children","docTitle","PermissionAlert","access","props","hasAccess","type","icon","size","DataForwardingStats","this","params","until","Math","floor","Date","getTime","options","query","since","resolution","stat","stats","state","series","seriesName","value","forwardedAny","some","withPadding","isGroupedByDate","showTimeInTooltip","labelYAxisExtents","height","description","AsyncComponent","ProjectDataForwarding","updatePlugin","hasConfiguration","setState","forwardingPlugins","includes","pluginsPanel","data-test-id","features","hookName","hasFeature","tct","link","href","em","alert","featureName","withOrganization"],"mappings":"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","file":"ProjectDataForwarding.e73060bd472715bddb0f.js","sourcesContent":["import React from 'react';\nimport styled from '@emotion/styled';\n\nimport {Panel, PanelBody, PanelHeader} from 'app/components/panels';\nimport TextOverflow from 'app/components/textOverflow';\nimport {t} from 'app/locale';\nimport PluginIcon from 'app/plugins/components/pluginIcon';\nimport space from 'app/styles/space';\nimport {Plugin} from 'app/types';\n\ntype Props = {\n  plugins: Plugin[];\n  onEnablePlugin: (plugin: Plugin) => void;\n};\n\nconst InactivePlugins = ({plugins, onEnablePlugin}: Props) => {\n  if (plugins.length === 0) {\n    return null;\n  }\n\n  return (\n    <Panel>\n      <PanelHeader>{t('Inactive Integrations')}</PanelHeader>\n\n      <PanelBody>\n        <Plugins>\n          {plugins.map(plugin => (\n            <IntegrationButton\n              key={plugin.id}\n              onClick={() => onEnablePlugin(plugin)}\n              className={`ref-plugin-enable-${plugin.id}`}\n            >\n              <Label>\n                <StyledPluginIcon pluginId={plugin.id} />\n                <TextOverflow>{plugin.shortName || plugin.name}</TextOverflow>\n              </Label>\n            </IntegrationButton>\n          ))}\n        </Plugins>\n      </PanelBody>\n    </Panel>\n  );\n};\n\nconst Plugins = styled('div')`\n  display: flex;\n  padding: ${space(1)};\n  flex: 1;\n  flex-wrap: wrap;\n`;\n\nconst IntegrationButton = styled('button')`\n  margin: ${space(1)};\n  width: 175px;\n  text-align: center;\n  font-size: ${p => p.theme.fontSizeSmall};\n  color: #889ab0;\n  letter-spacing: 0.1px;\n  font-weight: 600;\n  text-transform: uppercase;\n  border: 1px solid #eee;\n  background: inherit;\n  border-radius: ${p => p.theme.borderRadius};\n  padding: 10px;\n\n  &:hover {\n    border-color: #ccc;\n  }\n`;\n\nconst Label = styled('div')`\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`;\n\nconst StyledPluginIcon = styled(PluginIcon)`\n  margin-right: ${space(1)};\n`;\n\nexport default InactivePlugins;\n","import React from 'react';\n\nimport {disablePlugin, enablePlugin} from 'app/actionCreators/plugins';\nimport InactivePlugins from 'app/components/inactivePlugins';\nimport PluginConfig from 'app/components/pluginConfig';\nimport {t} from 'app/locale';\nimport {Organization, Plugin, Project} from 'app/types';\n\nimport {Panel, PanelItem} from './panels';\n\ntype Props = {\n  organization: Organization;\n  project: Project;\n  pluginList: Plugin[];\n  onDisablePlugin?: (plugin: Plugin) => void;\n  onEnablePlugin?: (plugin: Plugin) => void;\n};\n\nconst PluginList = ({\n  organization,\n  project,\n  pluginList,\n  onDisablePlugin = () => {},\n  onEnablePlugin = () => {},\n}: Props) => {\n  const handleEnablePlugin = (plugin: Plugin) => {\n    enablePlugin({\n      projectId: project.slug,\n      orgId: organization.slug,\n      pluginId: plugin.slug,\n    });\n\n    onEnablePlugin(plugin);\n  };\n\n  const handleDisablePlugin = (plugin: Plugin) => {\n    disablePlugin({\n      projectId: project.slug,\n      orgId: organization.slug,\n      pluginId: plugin.slug,\n    });\n\n    onDisablePlugin(plugin);\n  };\n\n  if (!pluginList.length) {\n    return (\n      <Panel>\n        <PanelItem>\n          {t(\"Oops! Looks like there aren't any available integrations installed.\")}\n        </PanelItem>\n      </Panel>\n    );\n  }\n\n  return (\n    <div>\n      {pluginList\n        .filter(p => p.enabled)\n        .map(data => (\n          <PluginConfig\n            data={data}\n            organization={organization}\n            project={project}\n            key={data.id}\n            onDisablePlugin={handleDisablePlugin}\n          />\n        ))}\n\n      <InactivePlugins\n        plugins={pluginList.filter(p => !p.enabled && !p.isHidden)}\n        onEnablePlugin={handleEnablePlugin}\n      />\n    </div>\n  );\n};\n\nexport default PluginList;\n","import React from 'react';\nimport DocumentTitle from 'react-document-title';\n\ntype Props = {\n  // Main page title\n  title: string;\n  orgSlug?: string;\n  projectSlug?: string;\n  children?: React.ReactNode;\n};\n\nfunction SentryDocumentTitle({title, orgSlug, projectSlug, children}: Props) {\n  function getDocTitle() {\n    if (!orgSlug && !projectSlug) {\n      return title;\n    }\n\n    if (orgSlug && projectSlug) {\n      return `${title} - ${orgSlug} - ${projectSlug}`;\n    }\n\n    if (orgSlug) {\n      return `${title} - ${orgSlug}`;\n    }\n\n    return `${title} - ${projectSlug}`;\n  }\n\n  const docTitle = getDocTitle();\n\n  return (\n    <DocumentTitle title={`${docTitle} - Sentry`}>\n      {children as React.ReactChild}\n    </DocumentTitle>\n  );\n}\n\nexport default SentryDocumentTitle;\n","import React from 'react';\n\nimport Access from 'app/components/acl/access';\nimport Alert from 'app/components/alert';\nimport {IconWarning} from 'app/icons';\nimport {t} from 'app/locale';\n\ntype Props = React.ComponentPropsWithoutRef<typeof Alert> &\n  Pick<React.ComponentProps<typeof Access>, 'access'>;\n\nconst PermissionAlert = ({access = ['project:write'], ...props}: Props) => (\n  <Access access={access}>\n    {({hasAccess}) =>\n      !hasAccess && (\n        <Alert type=\"warning\" icon={<IconWarning size=\"xs\" />} {...props}>\n          {t(\n            'These settings can only be edited by users with the organization owner, manager, or admin role.'\n          )}\n        </Alert>\n      )\n    }\n  </Access>\n);\n\nexport default PermissionAlert;\n","import React from 'react';\nimport {RouteComponentProps} from 'react-router';\n\nimport Feature from 'app/components/acl/feature';\nimport FeatureDisabled from 'app/components/acl/featureDisabled';\nimport Alert from 'app/components/alert';\nimport AsyncComponent from 'app/components/asyncComponent';\nimport MiniBarChart from 'app/components/charts/miniBarChart';\nimport ExternalLink from 'app/components/links/externalLink';\nimport {Panel, PanelBody, PanelHeader} from 'app/components/panels';\nimport PluginList from 'app/components/pluginList';\nimport SentryDocumentTitle from 'app/components/sentryDocumentTitle';\nimport {IconInfo} from 'app/icons';\nimport {t, tct} from 'app/locale';\nimport {Organization, Plugin, Project, TimeseriesValue} from 'app/types';\nimport {Series} from 'app/types/echarts';\nimport withOrganization from 'app/utils/withOrganization';\nimport EmptyMessage from 'app/views/settings/components/emptyMessage';\nimport SettingsPageHeader from 'app/views/settings/components/settingsPageHeader';\nimport TextBlock from 'app/views/settings/components/text/textBlock';\nimport PermissionAlert from 'app/views/settings/project/permissionAlert';\n\ntype RouteParams = {projectId: string; orgId: string};\n\ntype StatProps = {\n  params: RouteParams;\n};\n\ntype StatState = AsyncComponent['state'] & {\n  stats: TimeseriesValue[];\n};\n\nclass DataForwardingStats extends AsyncComponent<StatProps, StatState> {\n  getEndpoints(): ReturnType<AsyncComponent['getEndpoints']> {\n    const {orgId, projectId} = this.props.params;\n    const until = Math.floor(new Date().getTime() / 1000);\n    const since = until - 3600 * 24 * 30;\n\n    const options = {\n      query: {\n        since,\n        until,\n        resolution: '1d',\n        stat: 'forwarded',\n      },\n    };\n\n    return [['stats', `/projects/${orgId}/${projectId}/stats/`, options]];\n  }\n\n  renderBody() {\n    const {projectId} = this.props.params;\n    const {stats} = this.state;\n    const series: Series = {\n      seriesName: t('Forwarded'),\n      data: stats.map(([timestamp, value]) => ({name: timestamp * 1000, value})),\n    };\n    const forwardedAny = series.data.some(({value}) => value > 0);\n\n    return (\n      <Panel>\n        <SentryDocumentTitle title={t('Data Forwarding')} projectSlug={projectId} />\n        <PanelHeader>{t('Forwarded events in the last 30 days (by day)')}</PanelHeader>\n        <PanelBody withPadding>\n          {forwardedAny ? (\n            <MiniBarChart\n              isGroupedByDate\n              showTimeInTooltip\n              labelYAxisExtents\n              series={[series]}\n              height={150}\n            />\n          ) : (\n            <EmptyMessage\n              title={t('Nothing forwarded in the last 30 days.')}\n              description={t('Total events forwarded to third party integrations.')}\n            />\n          )}\n        </PanelBody>\n      </Panel>\n    );\n  }\n}\n\ntype Props = RouteComponentProps<RouteParams, {}> & {\n  organization: Organization;\n  project: Project;\n};\n\ntype State = AsyncComponent['state'] & {\n  plugins: Plugin[];\n};\n\nclass ProjectDataForwarding extends AsyncComponent<Props, State> {\n  getEndpoints(): ReturnType<AsyncComponent['getEndpoints']> {\n    const {orgId, projectId} = this.props.params;\n\n    return [['plugins', `/projects/${orgId}/${projectId}/plugins/`]];\n  }\n\n  get forwardingPlugins() {\n    return this.state.plugins.filter(\n      p => p.type === 'data-forwarding' && p.hasConfiguration\n    );\n  }\n\n  updatePlugin(plugin: Plugin, enabled: boolean) {\n    const plugins = this.state.plugins.map(p => ({\n      ...p,\n      enabled: p.id === plugin.id ? enabled : p.enabled,\n    }));\n\n    this.setState({plugins});\n  }\n\n  onEnablePlugin = (plugin: Plugin) => this.updatePlugin(plugin, true);\n  onDisablePlugin = (plugin: Plugin) => this.updatePlugin(plugin, false);\n\n  renderBody() {\n    const {params, organization, project} = this.props;\n    const plugins = this.forwardingPlugins;\n    const hasAccess = organization.access.includes('project:write');\n\n    const pluginsPanel =\n      plugins.length > 0 ? (\n        <PluginList\n          organization={organization}\n          project={project}\n          pluginList={plugins}\n          onEnablePlugin={this.onEnablePlugin}\n          onDisablePlugin={this.onDisablePlugin}\n        />\n      ) : (\n        <Panel>\n          <EmptyMessage\n            title={t('There are no integrations available for data forwarding')}\n          />\n        </Panel>\n      );\n\n    return (\n      <div data-test-id=\"data-forwarding-settings\">\n        <Feature\n          features={['projects:data-forwarding']}\n          hookName=\"feature-disabled:data-forwarding\"\n        >\n          {({hasFeature, features}) => (\n            <React.Fragment>\n              <SettingsPageHeader title={t('Data Forwarding')} />\n              <TextBlock>\n                {tct(\n                  `Data Forwarding allows processed events to be sent to your\n                favorite business intelligence tools. The exact payload and\n                types of data depend on the integration you're using. Learn\n                more about this functionality in our [link:documentation].`,\n                  {\n                    link: (\n                      <ExternalLink href=\"https://docs.sentry.io/product/data-management-settings/data-forwarding/\" />\n                    ),\n                  }\n                )}\n              </TextBlock>\n              <PermissionAlert />\n\n              <Alert icon={<IconInfo size=\"md\" />}>\n                {tct(\n                  `Sentry forwards [em:all applicable events] to the provider, in\n                some cases this may be a significant volume of data.`,\n                  {\n                    em: <strong />,\n                  }\n                )}\n              </Alert>\n\n              {!hasFeature && (\n                <FeatureDisabled\n                  alert\n                  featureName=\"Data Forwarding\"\n                  features={features}\n                />\n              )}\n\n              <DataForwardingStats params={params} />\n              {hasAccess && hasFeature && pluginsPanel}\n            </React.Fragment>\n          )}\n        </Feature>\n      </div>\n    );\n  }\n}\n\nexport default withOrganization(ProjectDataForwarding);\n"],"sourceRoot":""}