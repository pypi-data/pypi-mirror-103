(self.webpackChunk=self.webpackChunk||[]).push([["app_components_createAlertButton_tsx"],{"./app/components/createAlertButton.tsx":(e,t,r)=>{"use strict";r.d(t,{K:()=>N,Z:()=>_});var n=r("../node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),a=r("../node_modules/@babel/runtime/helpers/esm/extends.js"),o=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=r("../node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),i=r("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),u=r("../node_modules/@emotion/styled-base/dist/styled-base.browser.esm.js"),c=r("../node_modules/@babel/runtime/regenerator/index.js"),l=r.n(c),p=r("../node_modules/react/index.js"),d=r("../node_modules/react-router/es/index.js"),v=r("./app/actionCreators/indicator.tsx"),f=r("./app/actionCreators/navigation.tsx"),y=r("./app/components/acl/access.tsx"),m=r("./app/components/alert.tsx"),g=r("./app/components/assistant/guideAnchor.tsx"),O=r("./app/components/button.tsx"),E=r("./app/components/links/link.tsx"),R=r("./app/icons/index.tsx"),b=r("./app/locale.tsx"),T=r("./app/utils/discover/fields.tsx"),S=r("./app/utils/withApi.tsx"),h=r("./app/views/alerts/utils/index.tsx"),A=r("./app/views/settings/incidentRules/constants.tsx"),j=r("../node_modules/@emotion/core/dist/core.browser.esm.js");function P(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function D(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?P(Object(r),!0).forEach((function(t){(0,o.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function x(e){var t=e.incompatibleQuery,r=e.eventView,n=e.orgId,a=e.onClose,o=t.hasProjectError,s=t.hasEnvironmentError,i=t.hasEventTypeError,u=t.hasYAxisError,c=Object.values(t).filter((function(e){return!0===e})).length,l=r.clone();l.query+=" event.type:error";var d=r.clone();d.query+=" event.type:transaction";var v=r.clone();v.query+=" event.type:default";var f=r.clone();f.query+=" event.type:error or event.type:default";var y="/organizations/".concat(n,"/discover/results/"),m={error:(0,j.tZ)(E.Z,{to:{pathname:y,query:l.generateQueryStringObject()}}),default:(0,j.tZ)(E.Z,{to:{pathname:y,query:v.generateQueryStringObject()}}),transaction:(0,j.tZ)(E.Z,{to:{pathname:y,query:d.generateQueryStringObject()}}),errorDefault:(0,j.tZ)(E.Z,{to:{pathname:y,query:f.generateQueryStringObject()}})};return(0,j.tZ)(C,{type:"warning",icon:(0,j.tZ)(R.aU,{color:"yellow300",size:"sm"})},1===c&&(0,j.tZ)(p.Fragment,null,o&&(0,b.t)("An alert can use data from only one Project. Select one and try again."),s&&(0,b.t)("An alert supports data from a single Environment or All Environments. Pick one try again."),i&&(0,b._N)("An alert needs a filter of [error:event.type:error], [default:event.type:default], [transaction:event.type:transaction], [errorDefault:(event.type:error OR event.type:default)]. Use one of these and try again.",m),u&&(0,b._N)("An alert can’t use the metric [yAxis] just yet. Select another metric and try again.",{yAxis:(0,j.tZ)(I,null,r.getYAxis())})),c>1&&(0,j.tZ)(p.Fragment,null,(0,b.t)("Yikes! That button didn’t work. Please fix the following problems:"),(0,j.tZ)(Z,null,o&&(0,j.tZ)("li",null,(0,b.t)("Select one Project.")),s&&(0,j.tZ)("li",null,(0,b.t)("Select a single Environment or All Environments.")),i&&(0,j.tZ)("li",null,(0,b._N)("Use the filter [error:event.type:error], [default:event.type:default], [transaction:event.type:transaction], [errorDefault:(event.type:error OR event.type:default)].",m)),u&&(0,j.tZ)("li",null,(0,b._N)("An alert can’t use the metric [yAxis] just yet. Select another metric and try again.",{yAxis:(0,j.tZ)(I,null,r.getYAxis())})))),(0,j.tZ)(q,{icon:(0,j.tZ)(R.bM,{color:"yellow300",size:"sm",isCircled:!0}),"aria-label":(0,b.t)("Close"),size:"zero",onClick:a,borderless:!0}))}function N(e){var t=e.projects,r=e.eventView,n=e.organization,o=e.referrer,u=e.onIncompatibleQuery,c=e.onSuccess,l=(0,s.Z)(e,["projects","eventView","organization","referrer","onIncompatibleQuery","onSuccess"]),p={hasProjectError:1!==r.project.length||-1===r.project[0],hasEnvironmentError:r.environment.length>1,hasEventTypeError:null===(0,h.A4)(r.query),hasYAxisError:function(e){var t,r=(0,T.nr)(e.getYAxis());if("field"===r.kind)return!0;var n=e.query.match(/event\.type:(transaction|error)/);if(!n)return!1;var a="error"===n[1]?A.yq:A.Yp,o=!a.aggregations.includes(r.function[0]),s=T.lx[r.function[0]];if(!s)return!1;var u=s.parameters.some((function(e){return"value"===e.kind&&"number"===e.dataType})),c=[""].concat((0,i.Z)(a.fields),(0,i.Z)(null!==(t=a.measurementKeys)&&void 0!==t?t:[])),l=!u&&!c.includes(r.function[1]);return o||l}(r)},d=t.find((function(e){return e.id==="".concat(r.project[0])})),v=Object.values(p).some((function(e){return e})),f=v?void 0:{pathname:"/organizations/".concat(n.slug,"/alerts/").concat(null==d?void 0:d.slug,"/new/"),query:D(D({},r.generateQueryStringObject()),{},{createFromDiscover:!0,referrer:o})};return(0,j.tZ)(w,(0,a.Z)({organization:n,onClick:function(e){if(v)return e.preventDefault(),void u((function(e){return(0,j.tZ)(x,{incompatibleQuery:p,eventView:r,orgId:n.slug,onClose:e})}),p);c()},to:f},l))}x.displayName="IncompatibleQueryAlert",N.displayName="CreateAlertFromViewButton";var w=(0,S.Z)((0,d.withRouter)((function(e){var t=e.organization,r=e.projectSlug,o=e.iconProps,i=e.referrer,u=e.router,c=e.hideIcon,p=e.api,d=e.showPermissionGuide,m=(0,s.Z)(e,["organization","projectSlug","iconProps","referrer","router","hideIcon","api","showPermissionGuide"]),T=t.features.includes("alert-wizard"),S=function(e){var r="/organizations/".concat(t.slug,"/alerts/").concat(e),n=T?"wizard":"new";return"".concat(r,"/").concat(n,"/").concat(i?"?referrer=".concat(i):"")};function h(e){e.preventDefault(),(0,f.T)(S(":projectId"),u)}function A(){return P.apply(this,arguments)}function P(){return(P=(0,n.Z)(l().mark((function e(){var r;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="/organizations/".concat(t.slug,"/"),(0,v.E3)(),e.prev=2,e.next=5,p.requestPromise(r,{method:"PUT",data:{alertsMemberWrite:!0}});case 5:(0,v.S9)((0,b.t)("Successfully updated organization settings")),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),(0,v.Iw)((0,b.t)("Unable to update organization settings"));case 11:case"end":return e.stop()}}),e,null,[[2,8]])})))).apply(this,arguments)}var D=(0,b._N)("Ask your organization owner or manager to [settingsLink:enable alerts access] for you.",{settingsLink:(0,j.tZ)(E.Z,{to:"/settings/".concat(t.slug)})}),x=function(e){var t;return(0,j.tZ)(O.ZP,(0,a.Z)({disabled:!e,title:e?void 0:D,icon:!c&&(0,j.tZ)(R.vr,o),to:r?S(r):void 0,tooltipProps:{isHoverable:!0,position:"top",popperStyle:{maxWidth:"270px"}},onClick:r?void 0:h},m),null!==(t=m.children)&&void 0!==t?t:(0,b.t)("Create Alert"))},N=!t.alertsMemberWrite&&!!d;return(0,j.tZ)(y.Z,{organization:t,access:["alerts:write"]},(function(e){var r=e.hasAccess;return N?(0,j.tZ)(y.Z,{organization:t,access:["org:write"]},(function(e){var t=e.hasAccess;return(0,j.tZ)(g.Z,{target:t?"alerts_write_owner":"alerts_write_member",onFinish:t?A:void 0},x(r))})):x(r)}))})));const _=w;var C=(0,u.Z)(m.Z,{target:"e173ycuj0",label:"StyledAlert"})("color:",(function(e){return e.theme.textColor}),";margin-bottom:0;"),Z=(0,u.Z)("ul",{target:"e173ycuj1",label:"StyledUnorderedList"})({name:"gx0lhm",styles:"margin-bottom:0;"}),I=(0,u.Z)("code",{target:"e173ycuj2",label:"StyledCode"})({name:"18n1sg8",styles:"background-color:transparent;padding:0;"}),q=(0,u.Z)(O.ZP,{target:"e173ycuj3",label:"StyledCloseButton"})({name:"1f7txv4",styles:"transition:opacity 0.1s linear;position:absolute;top:3px;right:0;&:hover,&:focus{background-color:transparent;opacity:1;}"})},"./app/views/alerts/types.tsx":(e,t,r)=>{"use strict";var n,a,o,s,i;r.d(t,{lm:()=>a,vt:()=>o,Xn:()=>s,Gb:()=>i}),function(e){e[e.DETECTED=0]="DETECTED",e[e.CREATED=1]="CREATED",e[e.TRIGGERED=2]="TRIGGERED"}(n||(n={})),function(e){e[e.CREATED=0]="CREATED",e[e.DETECTED=1]="DETECTED",e[e.STATUS_CHANGE=2]="STATUS_CHANGE",e[e.COMMENT=3]="COMMENT",e[e.STARTED=4]="STARTED"}(a||(a={})),function(e){e[e.OPENED=1]="OPENED",e[e.CLOSED=2]="CLOSED",e[e.WARNING=10]="WARNING",e[e.CRITICAL=20]="CRITICAL"}(o||(o={})),function(e){e[e.MANUAL=1]="MANUAL",e[e.RULE_UPDATED=2]="RULE_UPDATED",e[e.RULE_TRIGGERED=3]="RULE_TRIGGERED"}(s||(s={})),function(e){e[e.PENDING=0]="PENDING",e[e.SNAPSHOT=4]="SNAPSHOT",e[e.DISABLED=5]="DISABLED"}(i||(i={}))},"./app/views/alerts/utils/index.tsx":(e,t,r)=>{"use strict";r.d(t,{dX:()=>f,hl:()=>y,yN:()=>m,KL:()=>g,Mg:()=>O,Nf:()=>E,FJ:()=>R,Un:()=>b,VD:()=>T,Eq:()=>S,Gm:()=>h,CM:()=>A,Ey:()=>j,KC:()=>P,A4:()=>D});var n,a,o=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=r("./app/api.tsx"),i=r("./app/locale.tsx"),u=r("./app/utils/dates.tsx"),c=(r("./app/utils/discover/eventView.tsx"),r("./app/utils/discover/fields.tsx"),r("./app/views/settings/incidentRules/incidentRulePresets.tsx")),l=r("./app/views/settings/incidentRules/presets.tsx"),p=r("./app/views/settings/incidentRules/types.tsx"),d=r("./app/views/alerts/types.tsx"),v=new s.KU;function f(e,t){return v.requestPromise("/organizations/".concat(e,"/alert-rules/").concat(t,"/"))}function y(e,t,r,n){return v.requestPromise("/organizations/".concat(e,"/incidents/"),{query:{alertRule:t,includeSnapshots:!0,start:r,end:n,expand:["activities","seen_by","original_alert_rule"]}})}function m(e,t,r){return e.requestPromise("/organizations/".concat(t,"/incidents/").concat(r,"/"))}function g(e,t,r){return e.requestPromise("/organizations/".concat(t,"/incidents/").concat(r,"/stats/"))}function O(e,t,r,n){var a=n?"POST":"DELETE";return e.requestPromise("/organizations/".concat(t,"/incidents/").concat(r,"/subscriptions/"),{method:a})}function E(e,t,r,n){return e.requestPromise("/organizations/".concat(t,"/incidents/").concat(r,"/"),{method:"PUT",data:{status:n}})}function R(e){switch(e.status){case d.vt.CLOSED:return!1;default:return!0}}function b(e){var t,r,n=null==e?void 0:e.alertRule,a=null!==(t=null==n?void 0:n.aggregate)&&void 0!==t?t:"",o=null!==(r=null==n?void 0:n.dataset)&&void 0!==r?r:p.qz.ERRORS;return l.g.find((function(e){return e.validDataset.includes(o)&&e.match.test(a)}))}function T(e){var t,r,n=null!==(t=null==e?void 0:e.aggregate)&&void 0!==t?t:"",a=null!==(r=null==e?void 0:e.dataset)&&void 0!==r?r:p.qz.ERRORS;return c.G.find((function(e){return e.validDataset.includes(a)&&e.match.test(n)}))}function S(e){return{start:(0,u.v5)(1e3*e.eventStats.data[0][0]),end:(0,u.v5)(1e3*e.eventStats.data[e.eventStats.data.length-1][0])}}function h(e){return!e.hasOwnProperty("triggers")}var A=(n={},(0,o.Z)(n,p.qz.ERRORS,(0,i.t)("Errors")),(0,o.Z)(n,p.qz.TRANSACTIONS,(0,i.t)("Transactions")),(0,o.Z)(n,p.Yh.ERROR_DEFAULT,(0,i.t)("event.type:error OR event.type:default")),(0,o.Z)(n,p.Yh.ERROR,(0,i.t)("event.type:error")),(0,o.Z)(n,p.Yh.DEFAULT,(0,i.t)("event.type:default")),(0,o.Z)(n,p.Yh.TRANSACTION,(0,i.t)("event.type:transaction")),n),j=(a={},(0,o.Z)(a,p.Yh.ERROR_DEFAULT,{dataset:p.qz.ERRORS,eventTypes:[p.GM.ERROR,p.GM.DEFAULT]}),(0,o.Z)(a,p.Yh.ERROR,{dataset:p.qz.ERRORS,eventTypes:[p.GM.ERROR]}),(0,o.Z)(a,p.Yh.DEFAULT,{dataset:p.qz.ERRORS,eventTypes:[p.GM.DEFAULT]}),(0,o.Z)(a,p.Yh.TRANSACTION,{dataset:p.qz.TRANSACTIONS,eventTypes:[p.GM.TRANSACTION]}),a);function P(e,t){return e===p.qz.TRANSACTIONS?p.Yh.TRANSACTION:t?t.includes(p.GM.DEFAULT)&&t.includes(p.GM.ERROR)?p.Yh.ERROR_DEFAULT:t.includes(p.GM.DEFAULT)?p.Yh.DEFAULT:p.Yh.ERROR:p.Yh.ERROR}function D(e){var t=e.match(/\(?\bevent\.type:(error|default|transaction)\)?\WOR\W\(?event\.type:(error|default|transaction)\)?/i);return t?"default,error"!==t.slice(1,3).sort().join(",")?null:{source:p.Yh.ERROR_DEFAULT,query:e.replace(t[0],"").trim()}:(t=e.match(/(^|\s)event\.type:(error|default|transaction)/i))&&p.Yh[t[2].toUpperCase()]?{source:p.Yh[t[2].toUpperCase()],query:e.replace(t[0],"").trim()}:null}},"./app/views/settings/incidentRules/constants.tsx":(e,t,r)=>{"use strict";r.d(t,{Vr:()=>d,Ng:()=>v,hh:()=>f,P1:()=>y,yq:()=>m,Yp:()=>g,W7:()=>O,ep:()=>E,H9:()=>R,Q6:()=>b});var n,a,o=r("../node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),s=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),i=r("./app/utils/performance/vitals/constants.tsx"),u=r("./app/views/alerts/utils/index.tsx"),c=r("./app/views/settings/incidentRules/types.tsx");function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){(0,s.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d="count()",v="p95(transaction.duration)",f=(n={},(0,s.Z)(n,c.qz.ERRORS,"event.type:error"),(0,s.Z)(n,c.qz.TRANSACTIONS,"event.type:transaction"),n),y=(a={},(0,s.Z)(a,c.Yh.ERROR_DEFAULT,"(event.type:error OR event.type:default)"),(0,s.Z)(a,c.Yh.ERROR,"event.type:error"),(0,s.Z)(a,c.Yh.DEFAULT,"event.type:default"),(0,s.Z)(a,c.Yh.TRANSACTION,"event.type:transaction"),a),m={aggregations:["count","count_unique"],fields:["user"]},g={aggregations:["avg","percentile","failure_rate","apdex","count","p50","p75","p95","p99","p100"],fields:["transaction.duration"],measurementKeys:Object.keys(i.r)};function O(e){return{label:e,alertThreshold:"",actions:[]}}function E(){return{dataset:c.qz.ERRORS,eventTypes:[c.GM.ERROR],aggregate:d,query:"",timeWindow:1,triggers:[O("critical"),O("warning")],projects:[],environment:null,resolveThreshold:"",thresholdType:c.lT.ABOVE}}function R(e){var t,r=(0,u.A4)(e.query),n=r?u.Ey[r.source]:u.Ey.error;return p(p(p({},E()),n),{},{query:null!==(t=null==r?void 0:r.query)&&void 0!==t?t:e.query,aggregate:"transactions"===n.dataset?"p95(transaction.duration)":e.getYAxis(),environment:e.environment.length?e.environment[0]:null})}function b(e){var t=e.eventTypes,r=(0,o.Z)(e,["eventTypes"]);return p(p({},E()),{},{eventTypes:[t]},r)}},"./app/views/settings/incidentRules/incidentRulePresets.tsx":(e,t,r)=>{"use strict";r.d(t,{G:()=>m,x:()=>O});var n=r("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),a=r("./app/locale.tsx"),o=r("./app/utils/discover/types.tsx"),s=r("./app/utils/tokenizeSearch.tsx"),i=r("../node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),u=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),c=r("./app/utils/discover/eventView.tsx"),l=r("./app/utils/discover/fields.tsx"),p=r("./app/views/settings/incidentRules/types.tsx");function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){(0,u.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function f(e){var t,r=e.orgSlug,n=e.projects,a=e.rule,o=e.start,s=e.end,u=e.extraQueryParams;if(!n||!n.length||!a||!o&&!s)return"";var d="".concat(a.timeWindow,"m"),f=v({id:void 0,name:a&&a.name||"",orderby:"-".concat((0,l.LY)(a.aggregate)),yAxis:a.aggregate,query:null!==(t=null==a?void 0:a.query)&&void 0!==t?t:"",projects:n.filter((function(e){var t=e.slug;return a.projects.includes(t)})).map((function(e){var t=e.id;return Number(t)})),version:2,fields:a.dataset===p.qz.ERRORS?["issue","count()","count_unique(user)"]:["transaction",a.aggregate],start:o,end:s},u),y=c.ZP.fromSavedQuery(f).getResultsViewUrlTarget(r),m=y.query,g=(0,i.Z)(y,["query"]);return v({query:v(v({},m),{},{interval:d})},g)}var y=r("./app/views/performance/transactionSummary/utils.tsx"),m=[{name:(0,a.t)("Error count"),match:/^count\(\)/,validDataset:[p.qz.ERRORS],default:"count()",makeCtaParams:O},{name:(0,a.t)("Users affected"),match:/^count_unique\(tags\[sentry:user\]\)/,validDataset:[p.qz.ERRORS],default:"count_unique(tags[sentry:user])",makeCtaParams:O},{name:(0,a.t)("Latency"),match:/^(p[0-9]{2,3}|percentile\(transaction\.duration,[^)]+\)|avg\([^)]+\))/,validDataset:[p.qz.TRANSACTIONS],default:"percentile(transaction.duration, 0.95)",makeCtaParams:function(e){return g({opts:e,tooltip:(0,a.t)("Latency by Transaction")})}},{name:(0,a.t)("Apdex"),match:/^apdex\([0-9.]+\)/,validDataset:[p.qz.TRANSACTIONS],default:"apdex(300)",makeCtaParams:function(e){return g({opts:e,tooltip:(0,a.t)("Apdex by Transaction")})}},{name:(0,a.t)("Transaction count"),match:/^count\(\)/,validDataset:[p.qz.TRANSACTIONS],default:"count()",makeCtaParams:function(e){return g({opts:e})}},{name:(0,a.t)("Failure rate"),match:/^failure_rate\(\)/,validDataset:[p.qz.TRANSACTIONS],default:"failure_rate()",makeCtaParams:function(e){var t,r,n=e.orgSlug,i=e.rule,u=e.projects,c=e.start,l=e.end;if(!i||!c&&!l)return{to:"",buttonText:(0,a.t)("Alert rule details")};var p=null===(r=(0,s.aI)(null!==(t=i.query)&&void 0!==t?t:"").getTagValues("transaction"))||void 0===r?void 0:r.find((function(e){return!e.includes("*")}));return{to:f({orgSlug:n,projects:u,rule:i,start:c,end:l,extraQueryParams:void 0!==p?{fields:["transaction.status","count()"],orderby:"-count",display:o.DC.TOP5}:{fields:["transaction","failure_rate()"],orderby:"-failure_rate",display:o.DC.TOP5}}),buttonText:(0,a.t)("Open in Discover"),title:void 0===p?(0,a.t)("Failure rate by transaction"):void 0}}}];function g(e){var t,r,i=e.opts,u=i.orgSlug,c=i.projects,l=i.rule,p=i.start,d=i.end,v=e.tooltip;if(!l||!p&&!d)return{to:"",buttonText:(0,a.t)("Alert rule details")};var m=null===(r=(0,s.aI)(null!==(t=l.query)&&void 0!==t?t:"").getTagValues("transaction"))||void 0===r?void 0:r.find((function(e){return!e.includes("*")}));if(void 0!==m)return{to:(0,y.e1)({orgSlug:u,transaction:m,projectID:c.filter((function(e){var t=e.slug;return l.projects.includes(t)})).map((function(e){return e.id})),query:{start:p,end:d}}),buttonText:(0,a.t)("View Transaction Summary"),title:m};var g={fields:(0,n.Z)(new Set(["transaction","count()",l.aggregate])),orderby:"-count",display:o.DC.TOP5};return{to:f({orgSlug:u,projects:c,rule:l,start:p,end:d,extraQueryParams:g}),buttonText:(0,a.t)("Open in Discover"),title:v}}function O(e){var t=e.orgSlug,r=e.projects,n=e.rule,s=e.start,i=e.end;if(!n)return{buttonText:(0,a.t)("Open in Discover"),to:""};var u={display:o.DC.TOP5};return{buttonText:(0,a.t)("Open in Discover"),to:f({orgSlug:t,projects:r,rule:n,start:s,end:i,extraQueryParams:u})}}},"./app/views/settings/incidentRules/presets.tsx":(e,t,r)=>{"use strict";r.d(t,{g:()=>E,x:()=>b});var n=r("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),a=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),o=r("./app/locale.tsx"),s=r("./app/utils/discover/types.tsx"),i=r("./app/utils/tokenizeSearch.tsx"),u=r("./app/views/alerts/utils/index.tsx"),c=r("../node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),l=r("./app/utils/discover/eventView.tsx"),p=r("./app/utils/discover/fields.tsx"),d=r("./app/views/settings/incidentRules/types.tsx");function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function y(e){var t,r=e.orgSlug,n=e.projects,a=e.incident,o=e.stats,s=e.extraQueryParams;if(!(n&&n.length&&a&&o))return"";var i="".concat(a.alertRule.timeWindow,"m"),v=(0,u.Eq)(o),y=v.start,m=v.end,g=f({id:void 0,name:a&&a.title||"",orderby:"-".concat((0,p.LY)(a.alertRule.aggregate)),yAxis:a.alertRule.aggregate,query:null!==(t=null==a?void 0:a.discoverQuery)&&void 0!==t?t:"",projects:n.filter((function(e){var t=e.slug;return a.projects.includes(t)})).map((function(e){var t=e.id;return Number(t)})),version:2,fields:a.alertRule.dataset===d.qz.ERRORS?["issue","count()","count_unique(user)"]:["transaction",a.alertRule.aggregate],start:y,end:m},s),O=l.ZP.fromSavedQuery(g).getResultsViewUrlTarget(r),E=O.query,R=(0,c.Z)(O,["query"]);return f({query:f(f({},E),{},{interval:i})},R)}var m=r("./app/views/performance/transactionSummary/utils.tsx");function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach((function(t){(0,a.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var E=[{name:(0,o.t)("Error count"),match:/^count\(\)/,validDataset:[d.qz.ERRORS],default:"count()",makeCtaParams:b},{name:(0,o.t)("Users affected"),match:/^count_unique\(tags\[sentry:user\]\)/,validDataset:[d.qz.ERRORS],default:"count_unique(tags[sentry:user])",makeCtaParams:b},{name:(0,o.t)("Latency"),match:/^(p[0-9]{2,3}|percentile\(transaction\.duration,[^)]+\)|avg\([^)]+\))/,validDataset:[d.qz.TRANSACTIONS],default:"percentile(transaction.duration, 0.95)",makeCtaParams:function(e){return R({opts:e,tooltip:(0,o.t)("Latency by Transaction")})}},{name:(0,o.t)("Apdex"),match:/^apdex\([0-9.]+\)/,validDataset:[d.qz.TRANSACTIONS],default:"apdex(300)",makeCtaParams:function(e){return R({opts:e,tooltip:(0,o.t)("Apdex by Transaction")})}},{name:(0,o.t)("Transaction Count"),match:/^count\(\)/,validDataset:[d.qz.TRANSACTIONS],default:"count()",makeCtaParams:function(e){return R({opts:e})}},{name:(0,o.t)("Failure rate"),match:/^failure_rate\(\)/,validDataset:[d.qz.TRANSACTIONS],default:"failure_rate()",makeCtaParams:function(e){var t,r,n=e.orgSlug,a=e.incident,u=e.projects,c=e.stats;if(!a||!c)return{to:"",buttonText:(0,o.t)("Incident details")};var l=null===(r=(0,i.aI)(null!==(t=a.discoverQuery)&&void 0!==t?t:"").getTagValues("transaction"))||void 0===r?void 0:r.find((function(e){return!e.includes("*")}));return{to:y({orgSlug:n,projects:u,incident:a,stats:c,extraQueryParams:void 0!==l?{fields:["transaction.status","count()"],orderby:"-count",display:s.DC.TOP5}:{fields:["transaction","failure_rate()"],orderby:"-failure_rate",display:s.DC.TOP5}}),buttonText:(0,o.t)("Open in Discover"),title:void 0===l?(0,o.t)("Failure rate by transaction"):void 0}}}];function R(e){var t,r,a=e.opts,c=a.orgSlug,l=a.projects,p=a.incident,d=a.stats,v=e.tooltip;if(!p||!d)return{to:"",buttonText:(0,o.t)("Incident details")};var f=null===(r=(0,i.aI)(null!==(t=p.discoverQuery)&&void 0!==t?t:"").getTagValues("transaction"))||void 0===r?void 0:r.find((function(e){return!e.includes("*")}));if(void 0!==f){var g=(0,u.Eq)(d);return{to:(0,m.e1)({orgSlug:c,transaction:f,projectID:l.filter((function(e){var t=e.slug;return p.projects.includes(t)})).map((function(e){return e.id})),query:O({},g)}),buttonText:(0,o.t)("View Transaction Summary"),title:f}}var E={fields:(0,n.Z)(new Set(["transaction","count()",p.alertRule.aggregate])),orderby:"-count",display:s.DC.TOP5};return{to:y({orgSlug:c,projects:l,incident:p,stats:d,extraQueryParams:E}),buttonText:(0,o.t)("Open in Discover"),title:v}}function b(e){var t=e.orgSlug,r=e.projects,n=e.incident,a=e.stats;if(!n)return{buttonText:(0,o.t)("Open in Discover"),to:""};var i={display:s.DC.TOP5};return{buttonText:(0,o.t)("Open in Discover"),to:y({orgSlug:t,projects:r,incident:n,stats:a,extraQueryParams:i})}}},"./app/views/settings/incidentRules/types.tsx":(e,t,r)=>{"use strict";r.d(t,{lT:()=>s,qz:()=>i,GM:()=>u,Yh:()=>c,XH:()=>l,Tb:()=>p,Us:()=>d,LO:()=>m,Lm:()=>y,hd:()=>g});var n,a,o,s,i,u,c,l,p,d,v=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),f=r("./app/locale.tsx");!function(e){e[e.INCIDENT=0]="INCIDENT",e[e.RESOLUTION=1]="RESOLUTION"}(o||(o={})),function(e){e[e.ABOVE=0]="ABOVE",e[e.BELOW=1]="BELOW"}(s||(s={})),function(e){e.ERRORS="events",e.TRANSACTIONS="transactions"}(i||(i={})),function(e){e.DEFAULT="default",e.ERROR="error",e.TRANSACTION="transaction"}(u||(u={})),function(e){e.ERROR_DEFAULT="error_default",e.DEFAULT="default",e.ERROR="error",e.TRANSACTION="transaction"}(c||(c={})),function(e){e.SIX_HOURS="6h",e.ONE_DAY="1d",e.THREE_DAYS="3d",e.SEVEN_DAYS="10000m",e.FOURTEEN_DAYS="14d",e.THIRTY_DAYS="30d"}(l||(l={})),function(e){e[e.ONE_MINUTE=1]="ONE_MINUTE",e[e.FIVE_MINUTES=5]="FIVE_MINUTES",e[e.TEN_MINUTES=10]="TEN_MINUTES",e[e.FIFTEEN_MINUTES=15]="FIFTEEN_MINUTES",e[e.THIRTY_MINUTES=30]="THIRTY_MINUTES",e[e.ONE_HOUR=60]="ONE_HOUR",e[e.TWO_HOURS=120]="TWO_HOURS",e[e.FOUR_HOURS=240]="FOUR_HOURS",e[e.ONE_DAY=1440]="ONE_DAY"}(p||(p={})),function(e){e.EMAIL="email",e.SLACK="slack",e.PAGERDUTY="pagerduty",e.MSTEAMS="msteams",e.SENTRY_APP="sentry_app"}(d||(d={}));var y,m=(n={},(0,v.Z)(n,d.EMAIL,(0,f.t)("Email")),(0,v.Z)(n,d.SLACK,(0,f.t)("Slack")),(0,v.Z)(n,d.PAGERDUTY,(0,f.t)("Pagerduty")),(0,v.Z)(n,d.MSTEAMS,(0,f.t)("MS Teams")),(0,v.Z)(n,d.SENTRY_APP,(0,f.t)("Notification")),n);!function(e){e.SPECIFIC="specific",e.USER="user",e.TEAM="team",e.SENTRY_APP="sentry_app"}(y||(y={}));var g=(a={},(0,v.Z)(a,y.USER,(0,f.t)("Member")),(0,v.Z)(a,y.TEAM,(0,f.t)("Team")),a)}}]);
//# sourceMappingURL=app_components_createAlertButton_tsx.js.map