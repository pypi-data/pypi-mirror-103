(self.webpackChunk=self.webpackChunk||[]).push([["GroupEventAttachments"],{"./app/components/acl/role.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>f});var r=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),s=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),l=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),i=n("../node_modules/react/index.js"),u=n("./app/stores/configStore.tsx"),c=n("../node_modules/js-cookie/src/js.cookie.js"),d=n.n(c),p=n("./app/utils/isRenderFunc.tsx"),m=n("./app/utils/withOrganization.tsx");var h=function(e){(0,o.Z)(c,e);var t,n,i=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,l.Z)(t);if(n){var s=(0,l.Z)(this).constructor;e=Reflect.construct(r,arguments,s)}else e=r.apply(this,arguments);return(0,a.Z)(this,e)});function c(){return(0,r.Z)(this,c),i.apply(this,arguments)}return(0,s.Z)(c,[{key:"hasRole",value:function(){var e,t=u.Z.get("user"),n=this.props,r=n.organization,s=n.role,o=r.availableRoles,a=null!==(e=r.role)&&void 0!==e?e:"";if(!t)return!1;if((u.Z.get("user")||{}).isSuperuser&&(d().set("su","test"),void 0===d().get("su")))return!0;if(!Array.isArray(o))return!1;var l=o.map((function(e){return e.id}));if(!l.includes(s)||!l.includes(a))return!1;var i=l.indexOf(s);return l.indexOf(a)>=i}},{key:"render",value:function(){var e=this.props.children,t=this.hasRole();return(0,p.l)(e)?e({hasRole:t}):t&&e?e:null}}]),c}(i.Component);h.displayName="Role";const f=(0,m.Z)(h)},"./app/components/events/eventAttachmentActions.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>O});var r=n("../node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),s=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),o=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),a=n("../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),l=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),i=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),u=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),c=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),d=n("../node_modules/@emotion/styled-base/dist/styled-base.browser.esm.js"),p=n("../node_modules/@babel/runtime/regenerator/index.js"),m=n.n(p),h=n("../node_modules/react/index.js"),f=n("./app/components/button.tsx"),b=n("./app/components/buttonBar.tsx"),y=n("./app/components/confirm.tsx"),v=n("./app/icons/index.tsx"),Z=n("./app/locale.tsx"),j=n("./app/styles/space.tsx"),g=n("./app/utils/withApi.tsx"),_=n("../node_modules/@emotion/core/dist/core.browser.esm.js");var x=function(e){(0,l.Z)(p,e);var t,n,d=(t=p,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,u.Z)(t);if(n){var s=(0,u.Z)(this).constructor;e=Reflect.construct(r,arguments,s)}else e=r.apply(this,arguments);return(0,i.Z)(this,e)});function p(){var e;(0,s.Z)(this,p);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return e=d.call.apply(d,[this].concat(n)),(0,c.Z)((0,a.Z)(e),"handleDelete",(0,r.Z)(m().mark((function t(){var n,r,s,o,a;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.props,r=n.api,s=n.url,o=n.onDelete,a=n.attachmentId,!s){t.next=10;break}return t.prev=2,t.next=5,r.requestPromise(s,{method:"DELETE"});case 5:o(a),t.next=10;break;case 8:t.prev=8,t.t0=t.catch(2);case 10:case"end":return t.stop()}}),t,null,[[2,8]])})))),e}return(0,o.Z)(p,[{key:"handlePreview",value:function(){var e=this.props,t=e.onPreview,n=e.attachmentId;t&&t(n)}},{key:"render",value:function(){var e=this,t=this.props,n=t.url,r=t.withPreviewButton,s=t.hasPreview,o=t.previewIsOpen;return(0,_.tZ)(b.Z,{gap:1},(0,_.tZ)(y.Z,{confirmText:(0,Z.t)("Delete"),message:(0,Z.t)("Are you sure you wish to delete this file?"),priority:"danger",onConfirm:this.handleDelete,disabled:!n},(0,_.tZ)(f.ZP,{size:"xsmall",icon:(0,_.tZ)(v.Fz,{size:"xs"}),label:(0,Z.t)("Delete"),disabled:!n,title:n?void 0:(0,Z.t)("Insufficient permissions to delete attachments")})),(0,_.tZ)(w,{size:"xsmall",icon:(0,_.tZ)(v.Dj,{size:"xs"}),href:n?"".concat(n,"?download=1"):"",disabled:!n,title:n?void 0:(0,Z.t)("Insufficient permissions to download attachments"),label:(0,Z.t)("Download")}),r&&(0,_.tZ)(w,{size:"xsmall",disabled:!n||!s,priority:o?"primary":"default",icon:(0,_.tZ)(v.fn,{size:"xs"}),onClick:function(){return e.handlePreview()},title:n?s?void 0:(0,Z.t)("This attachment cannot be previewed"):(0,Z.t)("Insufficient permissions to preview attachments")},(0,Z.t)("Preview")))}}]),p}(h.Component);x.displayName="EventAttachmentActions";var w=(0,d.Z)(f.ZP,{target:"erg6n450",label:"DownloadButton"})("margin-right:",(0,j.Z)(.5),";");const O=(0,g.Z)(x)},"./app/components/fileSize.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>l}),n("../node_modules/react/index.js");var r=n("./app/utils.tsx"),s=n("./app/utils/getDynamicText.tsx"),o=n("../node_modules/@emotion/core/dist/core.browser.esm.js");function a(e){var t=e.className,n=e.bytes;return(0,o.tZ)("span",{className:t},(0,s.Z)({value:(0,r.F)(n),fixed:"xx KB"}))}a.displayName="FileSize";const l=a},"./app/utils/attachmentUrl.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var r=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),s=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),o=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),a=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),l=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),i=n("../node_modules/react/index.js"),u=n("./app/components/acl/role.tsx"),c=n("./app/utils/withOrganization.tsx"),d=n("../node_modules/@emotion/core/dist/core.browser.esm.js");var p=function(e){(0,o.Z)(c,e);var t,n,i=(t=c,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,l.Z)(t);if(n){var s=(0,l.Z)(this).constructor;e=Reflect.construct(r,arguments,s)}else e=r.apply(this,arguments);return(0,a.Z)(this,e)});function c(){return(0,r.Z)(this,c),i.apply(this,arguments)}return(0,s.Z)(c,[{key:"getDownloadUrl",value:function(){var e=this.props,t=e.attachment,n=e.organization,r=e.eventId,s=e.projectId;return"/api/0/projects/".concat(n.slug,"/").concat(s,"/events/").concat(r,"/attachments/").concat(t.id,"/")}},{key:"render",value:function(){var e=this,t=this.props,n=t.children,r=t.organization;return(0,d.tZ)(u.Z,{role:r.attachmentsRole},(function(t){var r=t.hasRole;return n(r?e.getDownloadUrl():null)}))}}]),c}(i.PureComponent);p.displayName="AttachmentUrl";const m=(0,c.Z)(p)},"./app/views/organizationGroupDetails/groupEventAttachments/groupEventAttachmentsFilter.tsx":(e,t,n)=>{"use strict";n.d(t,{M:()=>y,Z:()=>j});var r=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),s=n("../node_modules/@emotion/styled-base/dist/styled-base.browser.esm.js"),o=(n("../node_modules/react/index.js"),n("../node_modules/react-router/es/index.js")),a=n("../node_modules/lodash/omit.js"),l=n.n(a),i=n("../node_modules/lodash/xor.js"),u=n.n(i),c=n("./app/components/button.tsx"),d=n("./app/components/buttonBar.tsx"),p=n("./app/locale.tsx"),m=n("./app/styles/space.tsx"),h=n("../node_modules/@emotion/core/dist/core.browser.esm.js");function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y=["event.minidump","event.applecrashreport"],v=function(e){var t=e.location,n=t.query,r=t.pathname,s=n.types,o=l()(n,"types"),a=b(b({},n),{},{types:y}),i="";return void 0===s?i="all":0===u()(y,s).length&&(i="onlyCrash"),(0,h.tZ)(Z,null,(0,h.tZ)(d.Z,{merged:!0,active:i},(0,h.tZ)(c.ZP,{barId:"all",size:"small",to:{pathname:r,query:o}},(0,p.t)("All Attachments")),(0,h.tZ)(c.ZP,{barId:"onlyCrash",size:"small",to:{pathname:r,query:a}},(0,p.t)("Only Crash Reports"))))};v.displayName="GroupEventAttachmentsFilter";var Z=(0,s.Z)("div",{target:"eftnont0",label:"FilterWrapper"})("display:flex;justify-content:flex-end;margin-bottom:",(0,m.Z)(3),";");const j=(0,o.withRouter)(v)},"./app/views/organizationGroupDetails/groupEventAttachments/index.tsx":(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>M});var r=n("../node_modules/react/index.js"),s=n("./app/components/acl/feature.tsx"),o=n("./app/components/acl/featureDisabled.tsx"),a=n("./app/utils/withOrganization.tsx"),l=n("../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),i=n("../node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),u=n("../node_modules/@babel/runtime/helpers/esm/createClass.js"),c=n("../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js"),d=n("../node_modules/@babel/runtime/helpers/esm/get.js"),p=n("../node_modules/@babel/runtime/helpers/esm/inherits.js"),m=n("../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js"),h=n("../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js"),f=n("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),b=n("../node_modules/react-router/es/index.js"),y=n("../node_modules/lodash/pick.js"),v=n.n(y),Z=n("./app/components/asyncComponent.tsx"),j=n("./app/components/emptyStateWarning.tsx"),g=n("./app/components/loadingIndicator.tsx"),_=n("./app/components/pagination.tsx"),x=n("./app/components/panels/index.tsx"),w=n("./app/locale.tsx"),O=n("./app/views/organizationGroupDetails/groupEventAttachments/groupEventAttachmentsFilter.tsx"),D=n("../node_modules/@emotion/styled-base/dist/styled-base.browser.esm.js"),R=n("./app/components/dateTime.tsx"),A=n("./app/components/events/eventAttachmentActions.tsx"),P=n("./app/components/fileSize.tsx"),k=n("./app/components/links/link.tsx"),I=n("./app/utils/attachmentUrl.tsx"),C={"event.minidump":(0,w.t)("Minidump"),"event.applecrashreport":(0,w.t)("Apple Crash Report"),"event.attachment":(0,w.t)("Other")},z=n("../node_modules/@emotion/core/dist/core.browser.esm.js"),E=function(e){var t=e.attachment,n=e.projectId,r=e.onDelete,s=e.isDeleted,o=e.orgId,a=e.groupId;return(0,z.tZ)(S,{isDeleted:s},(0,z.tZ)("td",null,(0,z.tZ)("h5",null,t.name,(0,z.tZ)("br",null),(0,z.tZ)("small",null,(0,z.tZ)(R.Z,{date:t.dateCreated})," ·"," ",(0,z.tZ)(k.Z,{to:"/organizations/".concat(o,"/issues/").concat(a,"/events/").concat(t.event_id,"/")},t.event_id)))),(0,z.tZ)("td",null,C[t.type]||(0,w.t)("Other")),(0,z.tZ)("td",null,(0,z.tZ)(P.Z,{bytes:t.size})),(0,z.tZ)("td",null,(0,z.tZ)(B,null,(0,z.tZ)(I.Z,{projectId:n,eventId:t.event_id,attachment:t},(function(e){return!s&&(0,z.tZ)(A.Z,{url:e,onDelete:r,attachmentId:t.id})})))))};E.displayName="GroupEventAttachmentsTableRow";var S=(0,D.Z)("tr",{target:"egfj2n60",label:"TableRow"})("opacity:",(function(e){return e.isDeleted?.3:1}),";td{text-decoration:",(function(e){return e.isDeleted?"line-through":"normal"}),";}"),B=(0,D.Z)("div",{target:"egfj2n61",label:"ActionsWrapper"})({name:"1baulvz",styles:"display:inline-block;"});const N=E;var T=function(e){var t=e.attachments,n=e.orgId,r=e.projectId,s=e.groupId,o=e.onDelete,a=e.deletedAttachments,l=[(0,w.t)("Name"),(0,w.t)("Type"),(0,w.t)("Size"),(0,w.t)("Actions")];return(0,z.tZ)("table",{className:"table events-table"},(0,z.tZ)("thead",null,(0,z.tZ)("tr",null,l.map((function(e){return(0,z.tZ)("th",{key:e},e)})))),(0,z.tZ)("tbody",null,t.map((function(e){return(0,z.tZ)(N,{key:e.id,attachment:e,orgId:n,projectId:r,groupId:s,onDelete:o,isDeleted:a.some((function(t){return e.id===t}))})}))))};T.displayName="GroupEventAttachmentsTable";const F=T;function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){(0,f.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var U=function(e){(0,p.Z)(o,e);var t,n,s=(t=o,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,r=(0,h.Z)(t);if(n){var s=(0,h.Z)(this).constructor;e=Reflect.construct(r,arguments,s)}else e=r.apply(this,arguments);return(0,m.Z)(this,e)});function o(){var e;(0,i.Z)(this,o);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e=s.call.apply(s,[this].concat(n)),(0,f.Z)((0,c.Z)(e),"handleDelete",(function(t){e.setState((function(e){return{deletedAttachments:[].concat((0,l.Z)(e.deletedAttachments),[t])}}))})),e}return(0,u.Z)(o,[{key:"getDefaultState",value:function(){return G(G({},(0,d.Z)((0,h.Z)(o.prototype),"getDefaultState",this).call(this)),{},{deletedAttachments:[]})}},{key:"getEndpoints",value:function(){var e=this.props,t=e.params,n=e.location;return[["eventAttachments","/issues/".concat(t.groupId,"/attachments/"),{query:G(G({},v()(n.query,["cursor","environment","types"])),{},{limit:50})}]]}},{key:"renderNoQueryResults",value:function(){return(0,z.tZ)(j.Z,null,(0,z.tZ)("p",null,(0,w.t)("Sorry, no event attachments match your search query.")))}},{key:"renderEmpty",value:function(){return(0,z.tZ)(j.Z,null,(0,z.tZ)("p",null,(0,w.t)("There don't seem to be any event attachments yet.")))}},{key:"renderLoading",value:function(){return this.renderBody()}},{key:"renderInnerBody",value:function(){var e=this.props,t=e.projectSlug,n=e.params,r=e.location,s=this.state,o=s.loading,a=s.eventAttachments,l=s.deletedAttachments;return o?(0,z.tZ)(g.Z,null):a.length>0?(0,z.tZ)(F,{attachments:a,orgId:n.orgId,projectId:t,groupId:n.groupId,onDelete:this.handleDelete,deletedAttachments:l}):r.query.types?this.renderNoQueryResults():this.renderEmpty()}},{key:"renderBody",value:function(){return(0,z.tZ)(r.Fragment,null,(0,z.tZ)(O.Z,null),(0,z.tZ)(x.s_,{className:"event-list"},(0,z.tZ)(x.N,null,this.renderInnerBody())),(0,z.tZ)(_.Z,{pageLinks:this.state.eventAttachmentsPageLinks}))}}]),o}(Z.Z);const L=b.withRouter(U);var W=function(e){var t=e.organization,n=e.group;return(0,z.tZ)(s.Z,{features:["event-attachments"],organization:t,renderDisabled:function(e){return(0,z.tZ)(o.Z,e)}},(0,z.tZ)(L,{projectSlug:n.project.slug}))};W.displayName="GroupEventAttachmentsContainer";const M=(0,a.Z)(W)},"../node_modules/lodash/_baseDifference.js":(e,t,n)=>{var r=n("../node_modules/lodash/_SetCache.js"),s=n("../node_modules/lodash/_arrayIncludes.js"),o=n("../node_modules/lodash/_arrayIncludesWith.js"),a=n("../node_modules/lodash/_arrayMap.js"),l=n("../node_modules/lodash/_baseUnary.js"),i=n("../node_modules/lodash/_cacheHas.js");e.exports=function(e,t,n,u){var c=-1,d=s,p=!0,m=e.length,h=[],f=t.length;if(!m)return h;n&&(t=a(t,l(n))),u?(d=o,p=!1):t.length>=200&&(d=i,p=!1,t=new r(t));e:for(;++c<m;){var b=e[c],y=null==n?b:n(b);if(b=u||0!==b?b:0,p&&y==y){for(var v=f;v--;)if(t[v]===y)continue e;h.push(b)}else d(t,y,u)||h.push(b)}return h}},"../node_modules/lodash/_baseXor.js":(e,t,n)=>{var r=n("../node_modules/lodash/_baseDifference.js"),s=n("../node_modules/lodash/_baseFlatten.js"),o=n("../node_modules/lodash/_baseUniq.js");e.exports=function(e,t,n){var a=e.length;if(a<2)return a?o(e[0]):[];for(var l=-1,i=Array(a);++l<a;)for(var u=e[l],c=-1;++c<a;)c!=l&&(i[l]=r(i[l]||u,e[c],t,n));return o(s(i,1),t,n)}},"../node_modules/lodash/xor.js":(e,t,n)=>{var r=n("../node_modules/lodash/_arrayFilter.js"),s=n("../node_modules/lodash/_baseRest.js"),o=n("../node_modules/lodash/_baseXor.js"),a=n("../node_modules/lodash/isArrayLikeObject.js"),l=s((function(e){return o(r(e,a))}));e.exports=l}}]);
//# sourceMappingURL=GroupEventAttachments.js.map