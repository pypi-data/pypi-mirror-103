{"version":3,"sources":["webpack:///./app/views/settings/incidentRules/details.tsx","webpack:///./app/views/settings/projectAlerts/edit.tsx"],"names":["IncidentRulesDetails","router","props","orgId","params","metric","name","push","actions","Map","this","ruleId","stateKey","data","onChangeTitle","teams","rule","state","userTeamIds","Set","filter","isMember","map","id","onSubmitSuccess","handleSubmitSuccess","AsyncView","withTeams","ProjectAlertsEditor","alertType","ruleName","setState","hasMetricAlerts","location","organization","project","pathname","includes","title","getTitle","orgSlug","slug","projectSlug","t","EditConditionsBody","fullWidth","handleChangeTitle","React","Layout","space"],"mappings":"42DA4BMA,E,uoBAoBkB,WAAM,IACnBC,EAAU,EAAKC,MAAfD,OACAE,EAAS,EAAKD,MAAME,OAApBD,MAEPE,oBAAsB,CAACC,KAAM,kBAC7BL,EAAOM,KAAP,yBAA8BJ,EAA9B,sB,gDAxBF,WACE,mFAEEK,QAAS,IAAIC,Q,0BAIjB,WAAsD,MAC5BC,KAAKR,MAAME,OAA5BD,EAD6C,EAC7CA,MAAOQ,EADsC,EACtCA,OAEd,MAAO,CAAC,CAAC,OAAD,yBAA2BR,EAA3B,wBAAgDQ,EAAhD,S,8BAGV,YAAmC,IAAjBC,EAAiB,EAAjBA,SAAUC,EAAO,EAAPA,KACT,SAAbD,GAAuBC,EAAKP,MAC9BI,KAAKR,MAAMY,cAAcD,EAAKP,Q,wBAYlC,WAAa,IACJS,EAASL,KAAKR,MAAda,MACAJ,EAAUD,KAAKR,MAAME,OAArBO,OACAK,EAAQN,KAAKO,MAAbD,KAEDE,EAAc,IAAIC,IAAIJ,EAAMK,QAAO,qBAAEC,YAAwBC,KAAI,qBAAEC,OAEzE,OACE,QAAC,KAAD,UACMb,KAAKR,MADX,CAEES,OAAQA,EACRK,KAAMA,EACNQ,gBAAiBd,KAAKe,oBACtBP,YAAaA,S,GAzCcQ,KA+CnC,SAAeC,OAAU3B,G,4EC7CnB4B,E,wnBACW,CACbC,UAAW,GACXC,SAAU,M,uCAGQ,SAAAA,GAClB,EAAKC,SAAS,CAACD,gB,yCAGjB,WAAW,IACFA,EAAYpB,KAAKO,MAAjBa,SACP,gBAAUA,K,oBAGZ,WAAS,MACoDpB,KAAKR,MAAzD8B,EADA,EACAA,gBAAiBC,EADjB,EACiBA,SAAUC,EAD3B,EAC2BA,aAAcC,EADzC,EACyCA,QAE1CN,EAAYI,EAASG,SAASC,SAAS,yBACzC,SACA,QAEJ,OACE,QAAC,WAAD,MACE,QAAC,IAAD,CACEC,MAAO5B,KAAK6B,WACZC,QAASN,EAAaO,KACtBC,YAAaP,EAAQM,QAEvB,QAAC,KAAD,MACE,QAAC,KAAD,MACE,QAAC,IAAD,CACET,gBAAiBA,EACjBQ,QAASN,EAAaO,KACtBH,OAAOK,OAAE,mBACTD,YAAaP,EAAQM,QAEvB,QAAC,KAAD,KAAe/B,KAAK6B,eAGxB,QAACK,EAAD,MACE,QAAC,KAAD,CAAaC,WAAS,KACjBb,GAAiC,UAAdH,KACpB,QAAC,KAAD,UACMnB,KAAKR,MADX,CAEEiC,QAASA,EACTrB,cAAeJ,KAAKoC,qBAGvBd,GAAiC,WAAdH,IAClB,QAAC,GAAD,UACMnB,KAAKR,MADX,CAEEiC,QAASA,EACTrB,cAAeJ,KAAKoC,4B,GArDFC,aAA5BnB,E,kCA+DN,IAAMgB,GAAqB,OAAOI,KAAP,gDAAH,mBACJC,OAAM,GADF,kCAQxB","file":"ProjectAlertsEdit.f928e7b91acc54787107.js","sourcesContent":["import React from 'react';\nimport {RouteComponentProps} from 'react-router';\n\nimport {Organization, Project, Team} from 'app/types';\nimport {metric} from 'app/utils/analytics';\nimport withTeams from 'app/utils/withTeams';\nimport AsyncView from 'app/views/asyncView';\nimport RuleForm from 'app/views/settings/incidentRules/ruleForm';\nimport {IncidentRule} from 'app/views/settings/incidentRules/types';\n\ntype RouteParams = {\n  orgId: string;\n  projectId: string;\n  ruleId: string;\n};\n\ntype Props = {\n  organization: Organization;\n  onChangeTitle: (data: string) => void;\n  project: Project;\n  teams: Team[];\n} & RouteComponentProps<RouteParams, {}>;\n\ntype State = {\n  rule: IncidentRule;\n  actions: Map<string, any>; // This is temp\n} & AsyncView['state'];\n\nclass IncidentRulesDetails extends AsyncView<Props, State> {\n  getDefaultState() {\n    return {\n      ...super.getDefaultState(),\n      actions: new Map(),\n    };\n  }\n\n  getEndpoints(): ReturnType<AsyncView['getEndpoints']> {\n    const {orgId, ruleId} = this.props.params;\n\n    return [['rule', `/organizations/${orgId}/alert-rules/${ruleId}/`]];\n  }\n\n  onRequestSuccess({stateKey, data}) {\n    if (stateKey === 'rule' && data.name) {\n      this.props.onChangeTitle(data.name);\n    }\n  }\n\n  handleSubmitSuccess = () => {\n    const {router} = this.props;\n    const {orgId} = this.props.params;\n\n    metric.endTransaction({name: 'saveAlertRule'});\n    router.push(`/organizations/${orgId}/alerts/rules/`);\n  };\n\n  renderBody() {\n    const {teams} = this.props;\n    const {ruleId} = this.props.params;\n    const {rule} = this.state;\n\n    const userTeamIds = new Set(teams.filter(({isMember}) => isMember).map(({id}) => id));\n\n    return (\n      <RuleForm\n        {...this.props}\n        ruleId={ruleId}\n        rule={rule}\n        onSubmitSuccess={this.handleSubmitSuccess}\n        userTeamIds={userTeamIds}\n      />\n    );\n  }\n}\n\nexport default withTeams(IncidentRulesDetails);\n","import React from 'react';\nimport {RouteComponentProps} from 'react-router';\nimport styled from '@emotion/styled';\n\nimport * as Layout from 'app/components/layouts/thirds';\nimport SentryDocumentTitle from 'app/components/sentryDocumentTitle';\nimport {t} from 'app/locale';\nimport space from 'app/styles/space';\nimport {Organization, Project} from 'app/types';\nimport BuilderBreadCrumbs from 'app/views/alerts/builder/builderBreadCrumbs';\nimport IncidentRulesDetails from 'app/views/settings/incidentRules/details';\nimport IssueEditor from 'app/views/settings/projectAlerts/issueRuleEditor';\n\ntype RouteParams = {\n  orgId: string;\n  projectId: string;\n  ruleId: string;\n};\n\ntype Props = RouteComponentProps<RouteParams, {}> & {\n  organization: Organization;\n  project: Project;\n  hasMetricAlerts: boolean;\n};\n\ntype State = {\n  alertType: string;\n  ruleName: string;\n};\n\nclass ProjectAlertsEditor extends React.Component<Props, State> {\n  state: State = {\n    alertType: '',\n    ruleName: '',\n  };\n\n  handleChangeTitle = ruleName => {\n    this.setState({ruleName});\n  };\n\n  getTitle() {\n    const {ruleName} = this.state;\n    return `${ruleName}`;\n  }\n\n  render() {\n    const {hasMetricAlerts, location, organization, project} = this.props;\n\n    const alertType = location.pathname.includes('/alerts/metric-rules/')\n      ? 'metric'\n      : 'issue';\n\n    return (\n      <React.Fragment>\n        <SentryDocumentTitle\n          title={this.getTitle()}\n          orgSlug={organization.slug}\n          projectSlug={project.slug}\n        />\n        <Layout.Header>\n          <Layout.HeaderContent>\n            <BuilderBreadCrumbs\n              hasMetricAlerts={hasMetricAlerts}\n              orgSlug={organization.slug}\n              title={t('Edit Alert Rule')}\n              projectSlug={project.slug}\n            />\n            <Layout.Title>{this.getTitle()}</Layout.Title>\n          </Layout.HeaderContent>\n        </Layout.Header>\n        <EditConditionsBody>\n          <Layout.Main fullWidth>\n            {(!hasMetricAlerts || alertType === 'issue') && (\n              <IssueEditor\n                {...this.props}\n                project={project}\n                onChangeTitle={this.handleChangeTitle}\n              />\n            )}\n            {hasMetricAlerts && alertType === 'metric' && (\n              <IncidentRulesDetails\n                {...this.props}\n                project={project}\n                onChangeTitle={this.handleChangeTitle}\n              />\n            )}\n          </Layout.Main>\n        </EditConditionsBody>\n      </React.Fragment>\n    );\n  }\n}\n\nconst EditConditionsBody = styled(Layout.Body)`\n  margin-bottom: -${space(3)};\n\n  *:not(img) {\n    max-width: 1000px;\n  }\n`;\n\nexport default ProjectAlertsEditor;\n"],"sourceRoot":""}