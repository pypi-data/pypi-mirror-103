{"version":3,"sources":["webpack:///./app/views/organizationJoinRequest.tsx","webpack:///./app/views/settings/components/forms/emailField.tsx","webpack:///./app/views/settings/components/forms/form.tsx"],"names":["OrganizationJoinRequest","submitSuccess","setState","e","preventDefault","orgId","props","params","window","location","assign","this","trackAdhocEvent","eventKey","org_slug","addErrorMessage","t","state","maxWidth","SuccessModal","StyledIconMegaphone","size","StyledHeader","StyledText","ReceiveEmailMessage","tct","requireChanges","apiEndpoint","apiMethod","submitLabel","onSubmitSuccess","handleSubmitSuccess","onSubmitError","handleSubmitError","onCancel","handleCancel","StyledEmailField","name","inline","label","placeholder","React","space","IconMegaphone","EmailField","type","Form","context","model","FormModel","skipPreventDefault","isSaving","onPreSubmit","onSubmit","getData","saveForm","data","error","submitError","saveOnBlur","resetOnError","onFieldChange","initialData","allowUndo","setInitialData","setFormOptions","form","reset","className","children","footerClass","footerStyle","submitDisabled","submitPriority","cancelLabel","extraButton","hideFooter","shouldShowFooter","data-test-id","isRenderFunc","StyledFooter","style","DefaultButtons","disabled","onClick","marginLeft","priority","isError","formChanged","PropTypes","p","Panel"],"mappings":"koCAqBMA,E,wnBACW,CACbC,cAAe,Q,yCAYK,WACpB,EAAKC,SAAS,CAACD,eAAe,Q,kCAOjB,SAAAE,GACbA,EAAEC,iBADgB,IAGXC,EAAS,EAAKC,MAAMC,OAApBF,MACPG,OAAOC,SAASC,OAAhB,sBAAsCL,EAAtC,S,kDArBF,WAAoB,IACXA,EAASM,KAAKL,MAAMC,OAApBF,OAEPO,QAAgB,CACdC,SAAU,sBACVC,SAAUT,M,+BAQd,YACEU,SAAgBC,OAAE,6B,oBAUpB,WAAS,IACAX,EAASM,KAAKL,MAAMC,OAApBF,MAGP,OAFwBM,KAAKM,MAAtBhB,eAIH,QAAC,IAAD,CAAciB,SAAS,UACrB,QAACC,EAAD,MACE,QAACC,EAAD,CAAqBC,KAAK,SAC1B,QAACC,EAAD,MAAeN,OAAE,kBACjB,QAACO,EAAD,MAAaP,OAAE,yCACf,QAACQ,EAAD,MACGC,QAAI,2DAA4D,CAACpB,cAQ1E,QAAC,IAAD,CAAca,SAAS,UACrB,QAACE,EAAD,CAAqBC,KAAK,SAC1B,QAACC,EAAD,MAAeN,OAAE,qBACjB,QAACO,EAAD,MACGE,QAAI,2DAA4D,CAC/DpB,YAGJ,QAAC,IAAD,CACEqB,gBAAc,EACdC,YAAW,yBAAoBtB,EAApB,kBACXuB,UAAU,OACVC,aAAab,OAAE,mBACfc,gBAAiBnB,KAAKoB,oBACtBC,cAAerB,KAAKsB,kBACpBC,SAAUvB,KAAKwB,eAEf,QAACC,EAAD,CACEC,KAAK,QACLC,QAAQ,EACRC,OAAOvB,OAAE,iBACTwB,YAAY,2B,GAtEcC,aAAhCzC,E,sCA8EN,IAAMmB,GAAe,OAAO,MAAP,2CAAH,wFAKEuB,OAAM,GALR,KAQZtB,GAAsB,OAAOuB,KAAP,kDAAH,mBACLD,OAAM,GADD,KAInBpB,GAAe,OAAO,KAAP,2CAAH,kBACCoB,OAAM,GADP,KAIZnB,GAAa,OAAO,IAAP,yCAAH,2CAIVC,GAAsB,OAAOD,EAAP,kDAAH,4CAInBa,GAAmB,OAAOQ,IAAP,+CAAH,gBACLF,OAAM,GADD,oBAKtB,W,gUC1He,SAASE,EAAWtC,GACjC,OAAO,QAAC,KAAD,UAAgBA,EAAhB,CAAuBuC,KAAK,WADbD,E,olCC0DHE,E,wcAMnB,WAAYxC,EAAcyC,GAAkB,sBAC1C,cAAMzC,EAAOyC,IAD6B,0BAsCzB,EAAKzC,MAAM0C,OAAS,IAAIC,MAtCC,8BAwCjC,SAAA9C,GAAK,SACb,EAAKG,MAAM4C,oBAAsB/C,EAAEC,iBAChC,EAAK4C,MAAMG,WAIf,eAAK7C,OAAM8C,mBAAX,iBAEI,EAAK9C,MAAM+C,SACb,EAAK/C,MAAM+C,SACT,EAAKL,MAAMM,UACX,EAAKxB,gBACL,EAAKE,cACL7B,EACA,EAAK6C,OAGP,EAAKA,MAAMO,gBAzD6B,qCA6D1B,SAAAC,GAAQ,IACjB1B,EAAmB,EAAKxB,MAAxBwB,gBACP,EAAKkB,MAAM/C,cAAcuD,GAErB1B,GACFA,EAAgB0B,EAAM,EAAKR,WAlEa,mCAsE5B,SAAAS,GAAS,IAChBzB,EAAiB,EAAK1B,MAAtB0B,cACP,EAAKgB,MAAMU,YAAYD,GAEnBzB,GACFA,EAAcyB,EAAO,EAAKT,UA3Ec,IAGxCW,EASErD,EATFqD,WACAhC,EAQErB,EARFqB,YACAC,EAOEtB,EAPFsB,UACAgC,EAMEtD,EANFsD,aACA9B,EAKExB,EALFwB,gBACAE,EAIE1B,EAJF0B,cACA6B,EAGEvD,EAHFuD,cACAC,EAEExD,EAFFwD,YACAC,EACEzD,EADFyD,UAXwC,OAc1C,EAAKf,MAAMgB,eAAeF,GAC1B,EAAKd,MAAMiB,eAAe,CACxBL,eACAG,YACAF,gBACA/B,kBACAE,gBACA2B,aACAhC,cACAC,cAvBwC,E,8CA2B5C,WACE,MAAO,CACL+B,WAAYhD,KAAKL,MAAMqD,WACvBO,KAAMvD,KAAKqC,S,kCAIf,WACErC,KAAKqC,MAAMmB,U,oBA4Cb,WAAS,aAeHxD,KAAKL,MAbP8D,EAFK,EAELA,UACAC,EAHK,EAGLA,SACAC,EAJK,EAILA,YACAC,EALK,EAKLA,YACAC,EANK,EAMLA,eACA3C,EAPK,EAOLA,YACA4C,EARK,EAQLA,eACAC,EATK,EASLA,YACAxC,EAVK,EAULA,SACAyC,EAXK,EAWLA,YACAjD,EAZK,EAYLA,eACAiC,EAbK,EAaLA,WACAiB,EAdK,EAcLA,WAEIC,OACkB,IAAfD,GAA8BA,GAAcjB,EAErD,OACE,gBACEN,SAAU1C,KAAK0C,SACfe,UAAWA,UAAa,eACxBU,eAAcnE,KAAKL,MAAM,kBAEzB,oBACGyE,OAAyBV,GAAYA,EAAS,CAACrB,MAAOrC,KAAKqC,QAAUqB,GAGvEQ,IACC,QAACG,EAAD,CACEZ,UAAWE,EACXW,MAAOV,EACPZ,WAAYA,GAEXgB,GACD,QAACO,EAAD,KACGhD,IACC,QAAC,KAAD,MACG,kBACC,QAAC,KAAD,CACEW,KAAK,SACLsC,SAAU,EAAKnC,MAAMG,SACrBiC,QAASlD,EACT+C,MAAO,CAACI,WAAY,IAEnBX,WAAe1D,OAAE,eAM1B,QAAC,KAAD,MACG,kBACC,QAAC,KAAD,CACE8D,eAAa,cACbQ,SAAUb,UAAkB,UAC5BU,SACE,EAAKnC,MAAMuC,SACX,EAAKvC,MAAMG,UACXqB,KACC9C,IAAkB,EAAKsB,MAAMwC,YAEhC3C,KAAK,UAEJhB,WAAeb,OAAE,2B,GAtJJyB,aAAbK,E,2BAAAA,E,oBACQ,CACzBa,WAAY8B,SACZvB,KAAMuB,aA+JV,IAAMT,GAAe,OAAO,MAAP,2CAAH,2IASd,SAAAU,GAAC,OACAA,EAAE/B,YAAH,cAEAgC,IAFA,4SAVc,KA6BZT,GAAiB,OAAO,MAAP,6CAAH,0BAENxC,OAAM,GAFA","file":"OrganizationJoinRequest.5b61f5cc2b1e3f38bf3b.js","sourcesContent":["import React from 'react';\nimport {Params} from 'react-router/lib/Router';\nimport styled from '@emotion/styled';\n\nimport {addErrorMessage} from 'app/actionCreators/indicator';\nimport NarrowLayout from 'app/components/narrowLayout';\nimport {IconMegaphone} from 'app/icons';\nimport {t, tct} from 'app/locale';\nimport space from 'app/styles/space';\nimport {trackAdhocEvent} from 'app/utils/analytics';\nimport EmailField from 'app/views/settings/components/forms/emailField';\nimport Form from 'app/views/settings/components/forms/form';\n\ntype Props = {\n  params: Params;\n};\n\ntype State = {\n  submitSuccess: boolean | null;\n};\n\nclass OrganizationJoinRequest extends React.Component<Props, State> {\n  state: State = {\n    submitSuccess: null,\n  };\n\n  componentDidMount() {\n    const {orgId} = this.props.params;\n\n    trackAdhocEvent({\n      eventKey: 'join_request.viewed',\n      org_slug: orgId,\n    });\n  }\n\n  handleSubmitSuccess = () => {\n    this.setState({submitSuccess: true});\n  };\n\n  handleSubmitError() {\n    addErrorMessage(t('Request to join failed'));\n  }\n\n  handleCancel = e => {\n    e.preventDefault();\n\n    const {orgId} = this.props.params;\n    window.location.assign(`/auth/login/${orgId}/`);\n  };\n\n  render() {\n    const {orgId} = this.props.params;\n    const {submitSuccess} = this.state;\n\n    if (submitSuccess) {\n      return (\n        <NarrowLayout maxWidth=\"550px\">\n          <SuccessModal>\n            <StyledIconMegaphone size=\"5em\" />\n            <StyledHeader>{t('Request Sent')}</StyledHeader>\n            <StyledText>{t('Your request to join has been sent.')}</StyledText>\n            <ReceiveEmailMessage>\n              {tct('You will receive an email when your request is approved.', {orgId})}\n            </ReceiveEmailMessage>\n          </SuccessModal>\n        </NarrowLayout>\n      );\n    }\n\n    return (\n      <NarrowLayout maxWidth=\"650px\">\n        <StyledIconMegaphone size=\"5em\" />\n        <StyledHeader>{t('Request to Join')}</StyledHeader>\n        <StyledText>\n          {tct('Ask the admins if you can join the [orgId] organization.', {\n            orgId,\n          })}\n        </StyledText>\n        <Form\n          requireChanges\n          apiEndpoint={`/organizations/${orgId}/join-request/`}\n          apiMethod=\"POST\"\n          submitLabel={t('Request to Join')}\n          onSubmitSuccess={this.handleSubmitSuccess}\n          onSubmitError={this.handleSubmitError}\n          onCancel={this.handleCancel}\n        >\n          <StyledEmailField\n            name=\"email\"\n            inline={false}\n            label={t('Email Address')}\n            placeholder=\"name@example.com\"\n          />\n        </Form>\n      </NarrowLayout>\n    );\n  }\n}\n\nconst SuccessModal = styled('div')`\n  display: grid;\n  justify-items: center;\n  text-align: center;\n  padding-top: 10px;\n  padding-bottom: ${space(4)};\n`;\n\nconst StyledIconMegaphone = styled(IconMegaphone)`\n  padding-bottom: ${space(3)};\n`;\n\nconst StyledHeader = styled('h3')`\n  margin-bottom: ${space(1)};\n`;\n\nconst StyledText = styled('p')`\n  margin-bottom: 0;\n`;\n\nconst ReceiveEmailMessage = styled(StyledText)`\n  max-width: 250px;\n`;\n\nconst StyledEmailField = styled(EmailField)`\n  padding-top: ${space(2)};\n  padding-left: 0;\n`;\n\nexport default OrganizationJoinRequest;\n","import React from 'react';\n\nimport InputField from './inputField';\n\ntype Props = InputField['props'];\n\nexport default function EmailField(props: Omit<Props, 'type'>) {\n  return <InputField {...props} type=\"email\" />;\n}\n","import React from 'react';\nimport styled from '@emotion/styled';\nimport {Observer} from 'mobx-react';\nimport PropTypes from 'prop-types';\n\nimport {APIRequestMethod} from 'app/api';\nimport Button from 'app/components/button';\nimport Panel from 'app/components/panels/panel';\nimport {t} from 'app/locale';\nimport space from 'app/styles/space';\nimport {isRenderFunc} from 'app/utils/isRenderFunc';\nimport FormModel, {FormOptions} from 'app/views/settings/components/forms/model';\n\ntype Data = Record<string, any>;\n\ntype RenderProps = {\n  model: FormModel;\n};\n\ntype RenderFunc = (props: RenderProps) => React.ReactNode;\n\ntype Props = {\n  apiMethod?: APIRequestMethod;\n  apiEndpoint?: string;\n  children?: React.ReactNode | RenderFunc;\n  className?: string;\n  cancelLabel?: string;\n  submitDisabled?: boolean;\n  submitLabel?: string;\n  submitPriority?: React.ComponentProps<typeof Button>['priority'];\n  footerClass?: string;\n  footerStyle?: React.CSSProperties;\n  extraButton?: React.ReactNode;\n  initialData?: Data;\n  // Require changes before able to submit form\n  requireChanges?: boolean;\n  // Reset form when there are errors; after submit\n  resetOnError?: boolean;\n  hideFooter?: boolean;\n  allowUndo?: boolean;\n  // Save field on control blur\n  saveOnBlur?: boolean;\n  model?: FormModel;\n  // if set to true, preventDefault is not called\n  skipPreventDefault?: boolean;\n  additionalFieldProps?: {[key: string]: any};\n  'data-test-id'?: string;\n\n  onCancel?: (e: React.MouseEvent) => void;\n  onSubmit?: (\n    data: Data,\n    onSubmitSuccess: (data: Data) => void,\n    onSubmitError: (error: any) => void,\n    e: React.FormEvent,\n    model: FormModel\n  ) => void;\n  onPreSubmit?: () => void;\n} & Pick<FormOptions, 'onSubmitSuccess' | 'onSubmitError' | 'onFieldChange'>;\n\ntype Context = {\n  saveOnBlur: boolean;\n  form: FormModel;\n};\n\nexport default class Form extends React.Component<Props> {\n  static childContextTypes = {\n    saveOnBlur: PropTypes.bool,\n    form: PropTypes.object,\n  };\n\n  constructor(props: Props, context: Context) {\n    super(props, context);\n    const {\n      saveOnBlur,\n      apiEndpoint,\n      apiMethod,\n      resetOnError,\n      onSubmitSuccess,\n      onSubmitError,\n      onFieldChange,\n      initialData,\n      allowUndo,\n    } = props;\n\n    this.model.setInitialData(initialData);\n    this.model.setFormOptions({\n      resetOnError,\n      allowUndo,\n      onFieldChange,\n      onSubmitSuccess,\n      onSubmitError,\n      saveOnBlur,\n      apiEndpoint,\n      apiMethod,\n    });\n  }\n\n  getChildContext() {\n    return {\n      saveOnBlur: this.props.saveOnBlur,\n      form: this.model,\n    };\n  }\n\n  componentWillUnmount() {\n    this.model.reset();\n  }\n\n  model: FormModel = this.props.model || new FormModel();\n\n  onSubmit = e => {\n    !this.props.skipPreventDefault && e.preventDefault();\n    if (this.model.isSaving) {\n      return;\n    }\n\n    this.props.onPreSubmit?.();\n\n    if (this.props.onSubmit) {\n      this.props.onSubmit(\n        this.model.getData(),\n        this.onSubmitSuccess,\n        this.onSubmitError,\n        e,\n        this.model\n      );\n    } else {\n      this.model.saveForm();\n    }\n  };\n\n  onSubmitSuccess = data => {\n    const {onSubmitSuccess} = this.props;\n    this.model.submitSuccess(data);\n\n    if (onSubmitSuccess) {\n      onSubmitSuccess(data, this.model);\n    }\n  };\n\n  onSubmitError = error => {\n    const {onSubmitError} = this.props;\n    this.model.submitError(error);\n\n    if (onSubmitError) {\n      onSubmitError(error, this.model);\n    }\n  };\n\n  render() {\n    const {\n      className,\n      children,\n      footerClass,\n      footerStyle,\n      submitDisabled,\n      submitLabel,\n      submitPriority,\n      cancelLabel,\n      onCancel,\n      extraButton,\n      requireChanges,\n      saveOnBlur,\n      hideFooter,\n    } = this.props;\n    const shouldShowFooter =\n      typeof hideFooter !== 'undefined' ? !hideFooter : !saveOnBlur;\n\n    return (\n      <form\n        onSubmit={this.onSubmit}\n        className={className ?? 'form-stacked'}\n        data-test-id={this.props['data-test-id']}\n      >\n        <div>\n          {isRenderFunc<RenderFunc>(children) ? children({model: this.model}) : children}\n        </div>\n\n        {shouldShowFooter && (\n          <StyledFooter\n            className={footerClass}\n            style={footerStyle}\n            saveOnBlur={saveOnBlur}\n          >\n            {extraButton}\n            <DefaultButtons>\n              {onCancel && (\n                <Observer>\n                  {() => (\n                    <Button\n                      type=\"button\"\n                      disabled={this.model.isSaving}\n                      onClick={onCancel}\n                      style={{marginLeft: 5}}\n                    >\n                      {cancelLabel ?? t('Cancel')}\n                    </Button>\n                  )}\n                </Observer>\n              )}\n\n              <Observer>\n                {() => (\n                  <Button\n                    data-test-id=\"form-submit\"\n                    priority={submitPriority ?? 'primary'}\n                    disabled={\n                      this.model.isError ||\n                      this.model.isSaving ||\n                      submitDisabled ||\n                      (requireChanges ? !this.model.formChanged : false)\n                    }\n                    type=\"submit\"\n                  >\n                    {submitLabel ?? t('Save Changes')}\n                  </Button>\n                )}\n              </Observer>\n            </DefaultButtons>\n          </StyledFooter>\n        )}\n      </form>\n    );\n  }\n}\n\nconst StyledFooter = styled('div')<{saveOnBlur?: boolean}>`\n  display: flex;\n  justify-content: flex-end;\n  margin-top: 25px;\n  border-top: 1px solid #e9ebec;\n  background: none;\n  padding: 16px 0 0;\n  margin-bottom: 16px;\n\n  ${p =>\n    !p.saveOnBlur &&\n    `\n  ${Panel} & {\n    margin-top: 0;\n    padding-right: 36px;\n  }\n\n  /* Better padding with form inside of a modal */\n  .modal-content & {\n    padding-right: 30px;\n    margin-left: -30px;\n    margin-right: -30px;\n    margin-bottom: -30px;\n    margin-top: 16px;\n    padding-bottom: 16px;\n  }\n  `};\n`;\n\nconst DefaultButtons = styled('div')`\n  display: grid;\n  grid-gap: ${space(1)};\n  grid-auto-flow: column;\n  justify-content: flex-end;\n  flex: 1;\n`;\n"],"sourceRoot":""}