(this["webpackJsonpfield-slicer"]=this["webpackJsonpfield-slicer"]||[]).push([[6],{111:function(e,t,n){"use strict";n(0);var i=n(11);t.a=function(e){var t=e.color,n=e.onClick,r=e.children,a={color:t||"gray",cursor:"pointer",textDecoration:"underline"};return Object(i.jsx)("span",{style:a,onClick:n,children:r})}},123:function(e,t,n){"use strict";var i=n(8),r=n(177),a=n(178),o=n(180),c=n(181),s=n(179),l=n(193),u=n(173),h=n(182),d=n(183),f=n(0),v=(n(124),n(11)),x=function(e){var t=e.title,n=e.rowKey,i=e.onDeleteRow,r=Object(f.useCallback)((function(){i&&i(n)}),[i,n]);return Object(v.jsx)(u.a,{title:t,onClick:r,children:Object(v.jsx)(h.a,{})})},b=function(e){var t=e.title,n=e.rowKey,i=e.onConfirmDeleteRow,r=Object(f.useCallback)((function(){i&&i(n,!0)}),[i,n]),a=Object(f.useCallback)((function(){i&&i(n,!1)}),[i,n]);return Object(v.jsxs)("span",{children:["Confirm delete?",Object(v.jsx)(u.a,{title:t,onClick:r,children:Object(v.jsx)(h.a,{})}),Object(v.jsx)(u.a,{title:"Cancel",onClick:a,children:"\u2716"})]})},g=function(e){var t=e.title,n=e.rowKey,i=e.onEditRow;return Object(v.jsx)(u.a,{title:t,onClick:function(){return i&&i(n)},children:Object(v.jsx)(d.a,{})})},m=function(e){return 0==e?e:e?"object"==typeof e?e.element?e.element:e.text||"":e:""};t.a=function(e){var t=e.rows,n=e.columns,u=e.onDeleteRow,h=void 0===u?void 0:u,d=e.deleteRowLabel,p=void 0===d?void 0:d,j=e.onEditRow,y=void 0===j?void 0:j,O=e.editRowLabel,_=void 0===O?void 0:O,k=e.selectionMode,M=void 0===k?"none":k,w=e.selectedRowKeys,D=void 0===w?{}:w,C=e.onSelectedRowKeysChanged,E=void 0===C?void 0:C,R=Object(f.useMemo)((function(){var e={};return Object.keys(D).forEach((function(t){e[t]=D[t]})),e}),[D]),P=Object(f.useState)(null),A=Object(i.a)(P,2),S=A[0],H=A[1],T=Object(f.useCallback)((function(e){E&&("single"===M?e in R&&R[e]?E([]):E([e+""]):"multiple"===M&&E(Object.keys(R).filter((function(t){return t!=e&&R[t]})).concat(R[e]?[]:[e.toString()])))}),[E,M,R]),I=Object(f.useCallback)((function(e){H(e)}),[]),W=Object(f.useCallback)((function(e,t){t&&h&&h(e),H(null)}),[h]),B=Object(f.useCallback)((function(e){y&&y(e)}),[y]);return Object(v.jsxs)(r.a,{className:"NiceTable",children:[Object(v.jsx)(a.a,{children:Object(v.jsxs)(o.a,{children:[Object(v.jsx)(c.a,{style:{width:0}},"_first"),n.map((function(e){return Object(v.jsx)(c.a,{children:Object(v.jsx)("span",{children:e.label})},e.key)}))]})}),Object(v.jsx)(s.a,{children:t.map((function(e){return Object(v.jsxs)(o.a,{children:[Object(v.jsxs)(c.a,{children:[h&&(S===e.key?Object(v.jsx)(b,{title:p||"",onConfirmDeleteRow:W,rowKey:e.key}):Object(v.jsx)(x,{title:p||"",onDeleteRow:I,rowKey:e.key})),y&&Object(v.jsx)(g,{title:_||"",onEditRow:B,rowKey:e.key}),"none"!==M&&Object(v.jsx)(l.a,{checked:R[e.key]||!1,onClick:function(){return T(e.key)}})]}),n.map((function(t){return Object(v.jsx)(c.a,{children:Object(v.jsx)("span",{children:m(e.columnValues[t.key])})},t.key)}))]},e.key)}))})]})}},124:function(e,t,n){},149:function(e,t){},187:function(e,t,n){"use strict";n.r(t),n.d(t,"activate",(function(){return me}));var i=n(0),r=n.n(i),a=n(111),o=n(123),c=n(11),s=function(e){var t=e.fieldModel,n=e.onClick,r=e.label,o=Object(i.useCallback)((function(){n(t.fieldModelId)}),[n,t.fieldModelId]);return Object(c.jsx)(a.a,{onClick:o,children:r})},l=function(e){var t=e.fieldModels,n=e.onFieldModelClicked,r=e.onDeleteFieldModels,a=Object(i.useMemo)((function(){return[{key:"fieldModelId",label:"Field Model"},{key:"fieldModelLabel",label:"Label"}]}),[]),l=Object(i.useMemo)((function(){return t.map((function(e){return{key:e.fieldModelId,columnValues:{fieldModelId:{text:e.fieldModelId,element:Object(c.jsxs)("span",{children:[Object(c.jsx)(s,{fieldModel:e,label:e.fieldModelId,onClick:n}),"\xa0\xa0\xa0"]})},fieldModelLabel:{text:e.fieldModelLabel,element:Object(c.jsxs)("span",{children:[Object(c.jsx)(s,{fieldModel:e,label:e.fieldModelLabel,onClick:n}),"\xa0\xa0\xa0"]})}}}}))}),[t,n]),u=Object(i.useCallback)((function(e){r([e])}),[r]);return Object(c.jsx)(o.a,{columns:a,rows:l,onDeleteRow:u})},u=n(8),h=n(15),d=n(13),f=n(186),v=function(e){return[[e.get([0,0]),e.get([0,1]),e.get([0,2]),e.get([0,3])],[e.get([1,0]),e.get([1,1]),e.get([1,2]),e.get([1,3])],[e.get([2,0]),e.get([2,1]),e.get([2,2]),e.get([2,3])]]},x=function(e){return Object(f.c)([[e[0][0],e[0][1],e[0][2],e[0][3]],[e[1][0],e[1][1],e[1][2],e[1][3]],[e[2][0],e[2][1],e[2][2],e[2][3]],[0,0,0,1]])},b=function(e,t){var n=x(e),i=x(t),r=Object(f.d)(n,i);return v(r)},g=function(e){var t=x(e),n=Object(f.b)(t);return v(n)},m=function(e,t,n,i){var r=t.map((function(t){return Object(h.a)(Object(h.a)({},t),{},{transformation:b(g(e.transformation),t.transformation)})})),a=n.map((function(t){return e.components.indexOf(t)})),o=function(e,t,n,i){var r=Object(d.e)("createjob_sample_data_object_slices",{data_uri:e,slices:t,component_indices:n,mode:i},{useClientCache:!0}),a=r.result;return r.job,a||void 0}(e.dataUri,r,a,i);return o?t.map((function(e,t){return{slice:e,components:n,data:o[t]}})):void 0},p=n(194),j=n(197),y=n(192),O=function(e){e.label;var t=e.value,n=e.onSetValue,i=e.options;return Object(c.jsx)(p.a,{value:t,onChange:function(e){return n(e.target.value)},row:!0,children:i.map((function(e){return Object(c.jsx)(j.a,{value:e.value,control:Object(c.jsx)(y.a,{}),label:e.label,disabled:!!e.disabled},e.label)}))})};var _,k,M,w=function(e){var t=e.currentMode,n=e.onCurrentModeChanged,r=Object(i.useCallback)((function(e){n(e)}),[n]);return Object(c.jsx)("div",{children:Object(c.jsx)(O,{label:"",value:t,onSetValue:r,options:["real","imag","abs"].map((function(e){return{label:e,value:e,disabled:!1}}))})})},D=n(25),C=n(19),E=n(2),R=n.n(E),P=n(53),A=n(9),S=n(10),H=function(e){if(e&&Array.isArray(e)&&2===e.length){var t,n=Object(D.a)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(!V(i))return!1}}catch(r){n.e(r)}finally{n.f()}return!0}return!1},T=function(e){if(e&&Array.isArray(e)&&3===e.length){var t,n=Object(D.a)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(!V(i))return!1}}catch(r){n.e(r)}finally{n.f()}return!0}return!1},I=function(e){return Object(f.a)(e.xmax-e.xmin)},W=function(e){return Object(f.a)(e.ymax-e.ymin)},B=function(e){return[e.xmin+I(e)/2,Math.min(e.ymin,e.ymax)+W(e)/2]},L=function(e){if(JSON.stringify(e.size())===JSON.stringify([3,3])){var t=e.toArray();if(JSON.stringify(t[2])===JSON.stringify([0,0,1]))return t}throw Error("Matrix ".concat(JSON.stringify(e)," is invalid as a transform matrix."))},N=function(e,t){2===t.length&&(t=[t[0],t[1],1]);var n=Object(f.c)(e),i=Object(f.c)(t);return Object(f.d)(n,i).toArray()},F=function(e,t){var n=Object(f.c)(e),i=Object(f.c)([[t.xmin,t.xmax],[t.ymin,t.ymax],[1,1]]),r=Object(f.d)(n,i).toArray(),a=r[0][0],o=r[0][1],c=r[1][0],s=r[1][1];return{xmin:Math.min(a,o),xmax:Math.max(a,o),ymin:Math.min(c,s),ymax:Math.max(c,s)}},V=function(e){return null!==e&&void 0!==e&&"number"===typeof e},K=function(){function e(t,n,i,r){Object(A.a)(this,e),this._exportingFigure=!1,this._context2D=void 0,this._pixelWidth=void 0,this._pixelHeight=void 0,this._primaryContext2D=void 0,this._offscreenCanvas=null,this._transformMatrix=void 0,this._context2D=t,this._primaryContext2D=t,this._pixelWidth=n,this._pixelHeight=i,this._transformMatrix=r}return Object(S.a)(e,[{key:"transform",value:function(t){try{var n=L(Object(f.d)(Object(f.c)(this._transformMatrix),Object(f.c)(t)));return new e(this._context2D,this._pixelWidth,this._pixelHeight,n)}catch(i){return console.warn("Problem transforming painter:",i),this}}},{key:"useOffscreenCanvas",value:function(e,t){try{var n=new OffscreenCanvas(Math.max(e,10),Math.max(t,10));this._offscreenCanvas=n;var i=n.getContext("2d");if(!i)throw Error("Unexpected");this._context2D=i}catch(r){console.warn("Problem in useOffscreenCanvas",r)}}},{key:"transferOffscreenToPrimary",value:function(){var e=this._offscreenCanvas;if(e){var t=e.transferToImageBitmap();this._context2D=this._primaryContext2D,this._context2D.clearRect(0,0,t.width,t.height),this._context2D.drawImage(t,0,0)}else console.warn("No offscreen canvas")}},{key:"getDefaultPen",value:function(){return{color:"black"}}},{key:"getDefaultFont",value:function(){return{"pixel-size":12,family:"Arial"}}},{key:"getDefaultBrush",value:function(){return{color:"black"}}},{key:"createPainterPath",value:function(){return new z}},{key:"setExportingFigure",value:function(e){this._exportingFigure=e}},{key:"exportingFigure",value:function(){return this._exportingFigure}},{key:"fillWholeCanvas",value:function(e){console.log("Pixel dimensions: 0 to ".concat(this._pixelWidth," and 0 to ").concat(this._pixelHeight)),this._context2D.save(),G(this._context2D,{color:e}),this._context2D.fillRect(0,0,this._pixelWidth,this._pixelHeight),this._context2D.restore()}},{key:"clear",value:function(){this.clearRect({xmin:0,xmax:this._pixelWidth,ymin:0,ymax:this._pixelHeight})}},{key:"clearRect",value:function(e){this.fillRect(e,{color:"transparent"})}},{key:"ctxSave",value:function(){this._context2D.save()}},{key:"ctxRestore",value:function(){this._context2D.restore()}},{key:"wipe",value:function(){this._context2D.clearRect(0,0,this._pixelWidth,this._pixelHeight)}},{key:"ctxTranslate",value:function(e){throw Error("Deprecated method, needs rewrite.")}},{key:"ctxRotate",value:function(e){this._context2D.rotate(e)}},{key:"fillRect",value:function(e,t){var n=F(this._transformMatrix,e);this._context2D.save(),G(this._context2D,t),this._context2D.fillRect(Math.min(n.xmin,n.xmax),Math.min(n.ymin,n.ymax),I(n),W(n)),this._context2D.restore()}},{key:"drawRect",value:function(e,t){var n=F(this._transformMatrix,e);this._context2D.save(),J(this._context2D,t),this._context2D.strokeRect(Math.min(n.xmin,n.xmax),Math.min(n.ymin,n.ymax),I(n),W(n)),this._context2D.restore()}},{key:"getEllipseFromBoundingRect",value:function(e){var t=F(this._transformMatrix,e);return{center:B(t),W:Math.abs(I(t)),H:Math.abs(W(t))}}},{key:"fillEllipse",value:function(e,t){var n=Object(h.a)({},this.getEllipseFromBoundingRect(e)),i=n.center,r=n.W,a=n.H;this._context2D.fillStyle=U(t.color),this._context2D.beginPath(),this._context2D.ellipse(i[0],i[1],r/2,a/2,0,0,2*Math.PI),this._context2D.fill()}},{key:"drawEllipse",value:function(e,t){var n=Object(h.a)({},this.getEllipseFromBoundingRect(e)),i=n.center,r=n.W,a=n.H;this._context2D.save(),J(this._context2D,t),this._context2D.beginPath(),this._context2D.ellipse(i[0],i[1],r/2,a/2,0,0,2*Math.PI),this._context2D.stroke(),this._context2D.restore()}},{key:"drawPath",value:function(e,t){this._context2D.save(),J(this._context2D,t),e._draw(this._context2D,this._transformMatrix),this._context2D.restore()}},{key:"drawLine",value:function(e,t,n,i,r){var a=new z;a.moveTo(e,t),a.lineTo(n,i),this.drawPath(a,r)}},{key:"drawText",value:function(e){var t,n,i=e.text,r=e.rect,a=e.alignment,o=e.font,c=e.pen,s=e.brush,l=e.orientation,u=void 0===l?"Horizontal":l,h=F(this._transformMatrix,r);this._context2D.save(),"Vertical"===u&&(this._context2D.rotate(-Math.PI/2),h={xmin:-(n=h).ymax,xmax:-n.ymin,ymin:n.xmin,ymax:n.xmax},a={Horizontal:"AlignBottom"===(t=a).Vertical?"AlignLeft":"AlignTop"===t.Vertical?"AlignRight":"AlignCenter",Vertical:"AlignRight"===t.Horizontal?"AlignBottom":"AlignLeft"===t.Horizontal?"AlignTop":"AlignCenter"}),Y(this._context2D,o);var d=function(e,t){var n,i,r="left",a="bottom";switch(t.Horizontal){case"AlignLeft":n=e.xmin,r="left";break;case"AlignCenter":n=B(e)[0],r="center";break;case"AlignRight":n=e.xmax,r="right";break;default:throw new Error("Missing horizontal alignment in drawText: AlignLeft, AlignCenter, or AlignRight")}switch(t.Vertical){case"AlignBottom":i=e.ymax,a="bottom";break;case"AlignCenter":i=B(e)[1],a="middle";break;case"AlignTop":i=e.ymin,a="top";break;default:throw new Error("Missing vertical alignment in drawText: AlignTop, AlignBottom, or AlignVCenter")}return{x:n,y:i,textAlign:r,textBaseline:a}}(h,a);X(this._context2D,d),J(this._context2D,c),G(this._context2D,s),this._context2D.translate(d.x,d.y),this._context2D.fillText(i,0,0),this._context2D.restore()}},{key:"drawMarker",value:function(e,t){var n=N(this._transformMatrix,e);this._context2D.save(),t.pen&&(J(this._context2D,t.pen),this._context2D.beginPath(),this._context2D.ellipse(n[0],n[1],t.radius,t.radius,0,0,2*Math.PI),this._context2D.stroke()),t.brush&&(G(this._context2D,t.brush),this._context2D.beginPath(),this._context2D.ellipse(n[0],n[1],t.radius,t.radius,0,0,2*Math.PI),this._context2D.fill()),this._context2D.restore()}},{key:"createImageData",value:function(e,t){return this._context2D.createImageData(e,t)}},{key:"getImageData",value:function(e,t,n,i){return this._context2D.getImageData(e,t,n,i)}},{key:"putImageData",value:function(e,t,n){this._context2D.putImageData(e,t,n)}}]),e}(),z=function(){function e(){Object(A.a)(this,e),this._actions=[]}return Object(S.a)(e,[{key:"moveTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(H(e))return this.moveTo(e[0],e[1]);if(!V(t))throw Error("unexpected");this._actions.push({name:"moveTo",x:e,y:t})}},{key:"lineTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(H(e))return this.lineTo(e[0],e[1]);if(!V(t))throw Error("unexpected");this._actions.push({name:"lineTo",x:e,y:t})}},{key:"_draw",value:function(e,t){var n=this;e.beginPath(),this._transformPathPoints(t).forEach((function(t){n._applyAction(e,t)})),e.stroke()}},{key:"_applyAction",value:function(e,t){"moveTo"===t.name?void 0!==t.x&&void 0!==t.y&&e.moveTo(t.x,t.y):"lineTo"===t.name&&void 0!==t.x&&void 0!==t.y&&e.lineTo(t.x,t.y)}},{key:"_transformPathPoints",value:function(e){var t=Object(f.c)(e);return this._actions.map((function(e){if(void 0!==e.x&&void 0!==e.y){var n=Object(f.c)([e.x,e.y,1]),i=Object(f.d)(t,n).toArray();return Object(h.a)(Object(h.a)({},e),{},{x:i[0],y:i[1]})}return e}))}}]),e}(),U=function(e){if(null!==(t=e)&&void 0!==t&&"string"===typeof t)return e;if(function(e){if(e&&Array.isArray(e)&&4===e.length){var t,n=Object(D.a)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(!V(i))return!1}}catch(r){n.e(r)}finally{n.f()}return!0}return!1}(e))return"rgba(".concat(Math.floor(e[0]),", ").concat(Math.floor(e[1]),", ").concat(Math.floor(e[2]),", ").concat(e[3],")");if(T(e))return"rgb(".concat(Math.floor(e[0]),", ").concat(Math.floor(e[1]),", ").concat(Math.floor(e[2]),")");throw Error("unexpected");var t},J=function(e,t){var n=t.color||"black",i=V(t.width)?t.width:1;e.strokeStyle=U(n),e.lineWidth=i||1},G=function(e,t){var n="color"in t?t.color:"black";e.fillStyle=U(n)},Y=function(e,t){var n=t.pixelSize||"12",i=t.family||"Arial";e.font="".concat(n,"px ").concat(i)},X=function(e,t){e.textAlign=t.textAlign,e.textBaseline=t.textBaseline};!function(e){e.Move="MOVE",e.Press="PRESS",e.Release="RELEASE"}(_||(_={})),function(e){e.Press="PRESS",e.Release="RELEASE"}(k||(k={})),function(e){e.Enter="ENTER",e.Leave="LEAVE",e.Out="OUT"}(M||(M={}));var q=function(e,t,n){var i=e.currentTarget,r=[e.clientX-i.getBoundingClientRect().x,e.clientY-i.getBoundingClientRect().y];if(n){var a=function(e,t,n){return N(e,[(i=[t,n])[0],i[1],1]);var i}(n,r[0],r[1]);r=[a[0],a[1]]}var o={alt:e.altKey,ctrl:e.ctrlKey||e.metaKey,shift:e.shiftKey};return{point:[r[0],r[1]],mouseButton:e.buttons,modifiers:o,type:t}},Q=function(){function e(t,n,i,r){Object(A.a)(this,e),this._onPaint=void 0,this._onPropsChange=void 0,this._runningOnPropsChange=!1,this._props=null,this._state=void 0,this._pixelWidth=null,this._pixelHeight=null,this._canvasElement=null,this._transformMatrix=void 0,this._inverseMatrix=void 0,this._repaintScheduled=!1,this._lastRepaintTimestamp=Number(new Date),this._discreteMouseEventHandlers=[],this._dragHandlers=[],this._keyboardEventHandlers=[],this._mousePresenceEventHandlers=[],this._wheelEventHandlers=[],this._refreshRate=120,this._state=i,this._onPaint=t,this._onPropsChange=n,this._discreteMouseEventHandlers=(null===r||void 0===r?void 0:r.discreteMouseEventHandlers)||[],this._dragHandlers=(null===r||void 0===r?void 0:r.dragHandlers)||[],this._keyboardEventHandlers=(null===r||void 0===r?void 0:r.keyboardEventHandlers)||[],this._mousePresenceEventHandlers=(null===r||void 0===r?void 0:r.mousePresenceEventHandlers)||[],this._wheelEventHandlers=(null===r||void 0===r?void 0:r.wheelEventHandlers)||[],this._transformMatrix=[[1,0,0],[0,1,0],[0,0,1]],this._inverseMatrix=[[1,0,0],[0,1,0],[0,0,1]]}return Object(S.a)(e,[{key:"getProps",value:function(){if(!this._props)throw Error("getProps must not be called before initial props are set");return this._props}},{key:"setProps",value:function(e){if(this._runningOnPropsChange)throw Error("Calling setProps inside onPropsChange is not allowed.");if(null===this._props||!Z(this._props,e)){this._props=e,this._pixelWidth=e.width,this._pixelHeight=e.height,this._runningOnPropsChange=!0;try{this._onPropsChange(this,e)}finally{this._runningOnPropsChange=!1}}}},{key:"getState",value:function(){return this._state}},{key:"setState",value:function(e){this._state=e}},{key:"getTransformMatrix",value:function(){return this._transformMatrix}},{key:"setTransformMatrix",value:function(e){this._transformMatrix=e;try{this._inverseMatrix=function(e){var t=Object(f.c)(e);return Object(f.b)(t).toArray()}(e)}catch(t){console.warn(t),console.warn("WARNING: problem getting inverse transformation matrix"),this._inverseMatrix=e}}},{key:"pixelWidth",value:function(){if(null===this._pixelWidth)throw Error("Cannot get pixelWidth before it is set");return this._pixelWidth}},{key:"pixelHeight",value:function(){if(null===this._pixelHeight)throw Error("Cannot get pixelHeight before it is set");return this._pixelHeight}},{key:"resetCanvasElement",value:function(e){this._canvasElement=e}},{key:"canvasElement",value:function(){return this._canvasElement}},{key:"refreshRate",value:function(){return this._refreshRate}},{key:"setRefreshRate",value:function(e){this._refreshRate=e}},{key:"scheduleRepaint",value:function(){var e=this;if(!this._repaintScheduled){var t=Number(new Date)-this._lastRepaintTimestamp,n=1e3/this._refreshRate;t>2*n?this._doRepaint():(this._repaintScheduled=!0,setTimeout((function(){e._repaintScheduled=!1,e._doRepaint()}),n))}}},{key:"repaintImmediate",value:function(){this._doRepaint()}},{key:"_doRepaint",value:function(){var e=Object(P.a)(R.a.mark((function e(){var t,n,i,r,a;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=null!==(t=null===(n=this._canvasElement)||void 0===n?void 0:n.getContext("2d"))&&void 0!==t?t:null){e.next=3;break}return e.abrupt("return");case 3:if(null!==this._pixelWidth&&null!==this._pixelHeight){e.next=5;break}return e.abrupt("return");case 5:if(r=new K(i,this._pixelWidth,this._pixelHeight,this._transformMatrix),!(a=this._onPaint(r,this._props,this._state))){e.next=11;break}return this._lastRepaintTimestamp=Number(new Date),e.next=11,a;case 11:this._lastRepaintTimestamp=Number(new Date);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleDiscreteEvent",value:function(e,t){if(0!==this._discreteMouseEventHandlers.length){var n,i=q(e,t,this._inverseMatrix),r=Object(D.a)(this._discreteMouseEventHandlers);try{for(r.s();!(n=r.n()).done;){(0,n.value)(i,this)}}catch(a){r.e(a)}finally{r.f()}}}},{key:"handleDrag",value:function(e,t,n,i,r){if(0!==this._dragHandlers.length){var a,o=F(this._inverseMatrix,e),c=i?N(this._inverseMatrix,[].concat(Object(C.a)(i),[1])):void 0,s=r?N(this._inverseMatrix,[].concat(Object(C.a)(r),[1])):void 0,l=Object(D.a)(this._dragHandlers);try{for(l.s();!(a=l.n()).done;){(0,a.value)(this,{dragRect:o,released:t,shift:n||!1,anchor:c,position:s})}}catch(u){l.e(u)}finally{l.f()}}}},{key:"handleKeyboardEvent",value:function(e,t){if(0===this._keyboardEventHandlers.length)return!0;var n,i=function(e,t){return{type:e,keyCode:t.keyCode}}(e,t),r=!0,a=Object(D.a)(this._keyboardEventHandlers);try{for(a.s();!(n=a.n()).done;){!1===(0,n.value)(i,this)&&(r=!1)}}catch(o){a.e(o)}finally{a.f()}return r}},{key:"handleMousePresenceEvent",value:function(e,t){if(0!==this._mousePresenceEventHandlers.length){var n,i={type:t},r=Object(D.a)(this._mousePresenceEventHandlers);try{for(r.s();!(n=r.n()).done;){(0,n.value)(i,this)}}catch(a){r.e(a)}finally{r.f()}}}},{key:"handleWheelEvent",value:function(e){if(0!==this._wheelEventHandlers.length){var t,n=function(e){return{deltaY:e.deltaY}}(e),i=Object(D.a)(this._wheelEventHandlers);try{for(i.s();!(t=i.n()).done;){(0,t.value)(n,this)}}catch(r){i.e(r)}finally{i.f()}}}}]),e}(),Z=function(e,t){for(var n in e)if(e[n]!==t[n])return!1;for(var i in t)if(e[i]!==t[i])return!1;return!0},$="COMPUTE_DRAG",ee="END_DRAG",te=function(e,t){var n=e.dragging,i=e.dragAnchor,r=t.type,a=t.mouseButton,o=t.point,c=t.shift;switch(r){case ee:return{dragging:!1};case $:if(!a)return{dragging:!1};if(!o)throw Error("Unexpected: no point");if(n&&!i)throw Error("Invalid state in computing drag: cannot have drag set with no dragAnchor.");if(!n&&!i)return{dragging:!1,dragAnchor:o,shift:c||!1};if(!n&&i){if(!(n=Math.abs(o[0]-i[0])>4||Math.abs(o[1]-i[1])>4))return{dragging:!1,dragAnchor:i,shift:c||!1}}if(n&&i)return{dragging:!0,dragAnchor:i,dragPosition:o,dragRect:[Math.min(i[0],o[0]),Math.min(i[1],o[1]),Math.abs(i[0]-o[0]),Math.abs(i[1]-o[1])],shift:c||!1};break;default:throw Error("Invalid mode for drag reducer.")}throw Error("Unexpected: unreachable, but keeps ESLint happy")},ne=function(e){var t=e.layers,n=e.preventDefaultWheel,a=e.width,o=e.height,s=Object(i.useState)(null),l=Object(u.a)(s,2),h=l[0],d=l[1],f=Object(i.useState)(!1),v=Object(u.a)(f,2),x=v[0],b=v[1],g=r.a.useCallback((function(e){d(e)}),[]);Object(i.useEffect)((function(){h&&(h._hasFocus=x)}),[x,h]),Object(i.useEffect)((function(){if(h&&t){var e=function(e){h._hasFocus&&e.preventDefault()};t.forEach((function(t,i){var r=h.children[i];r&&t?(n&&r.addEventListener("wheel",e),t.resetCanvasElement(r),t.scheduleRepaint()):console.warn("Unable to get canvas element for layer",i)}))}}),[h,t,n]);var m=Object(i.useReducer)(te,{dragging:!1}),p=Object(u.a)(m,2),j=p[0],y=p[1],O=Object(i.useRef)(null);Object(i.useEffect)((function(){t.forEach((function(e){e&&e.scheduleRepaint()}))}),[a,o,t]);var w=Object(i.useState)(null),C=Object(u.a)(w,2),E=C[0],R=C[1];Object(i.useEffect)((function(){var e=null;if(e=j.dragging?j:E&&E.dragging?E:null){var n=e.dragRect;if(n){var i,r={xmin:n[0],xmax:n[0]+n[2],ymin:n[1]+n[3],ymax:n[1]},a=Object(D.a)(t);try{for(a.s();!(i=a.n()).done;){var o=i.value;o&&o.handleDrag(r,!j.dragging,e.shift,e.dragAnchor,e.dragPosition)}}catch(c){a.e(c)}finally{a.f()}}}R(j)}),[j,E,R,t]);var P,A=Object(i.useCallback)((function(e,n){if(!j.dragging){var i,r=Object(D.a)(t);try{for(r.s();!(i=r.n()).done;){var a=i.value;a&&a.handleDiscreteEvent(e,n)}}catch(o){r.e(o)}finally{r.f()}}}),[t,j]),S=Object(i.useCallback)((function(e,n){if(t){var i,r=Object(D.a)(t);try{for(r.s();!(i=r.n()).done;){var a=i.value;a&&a.handleMousePresenceEvent(e,n)}}catch(o){r.e(o)}finally{r.f()}}}),[t]),H=Object(i.useCallback)((function(e){var t,n=q(e,_.Move),i=n.point,r=n.mouseButton,a=n.modifiers;t={type:$,mouseButton:1===r,point:i,shift:a.shift||!1},O.current?O.current=t:(O.current=t,setTimeout((function(){var e=O.current;O.current=null,e&&y(e)}),30)),A(e,_.Move)}),[A]),T=Object(i.useCallback)((function(e){var t=q(e,_.Press),n=t.point,i=t.modifiers;A(e,_.Press),y({type:$,mouseButton:!0,point:n,shift:i.shift||!1})}),[A]),I=Object(i.useCallback)((function(e){b(!0);var t=q(e,_.Move),n=t.point,i=t.mouseButton,r=t.modifiers;A(e,_.Release),y({type:$,mouseButton:1===i,point:n,shift:r.shift||!1}),y({type:ee})}),[A,y]),W=Object(i.useCallback)((function(e){S(e,M.Enter)}),[S]),B=Object(i.useCallback)((function(e){b(!1),S(e,M.Leave)}),[S]),L=Object(i.useCallback)((function(e){var n,i=Object(D.a)(t);try{for(i.s();!(n=i.n()).done;){var r=n.value;r&&r.handleWheelEvent(e)}}catch(a){i.e(a)}finally{i.f()}}),[t]),N=Object(i.useCallback)((function(e){var n,i=Object(D.a)(t);try{for(i.s();!(n=i.n()).done;){var r=n.value;r&&!1===r.handleKeyboardEvent(k.Press,e)&&e.preventDefault()}}catch(a){i.e(a)}finally{i.f()}}),[t]),F=Object(D.a)(t);try{for(F.s();!(P=F.n()).done;){var V=P.value;if(V){var K=V.getProps(),z=K.width,U=K.height;if(z!==a||U!==o)throw console.warn(z,U,a,o),Error("Inconsistent width or height between canvas widget and layer")}}}catch(J){F.e(J)}finally{F.f()}return Object(c.jsx)("div",{ref:g,style:{position:"relative",width:a,height:o,left:0,top:0},onKeyDown:N,tabIndex:0,children:(t||[]).map((function(e,t){return Object(c.jsx)("canvas",{style:{position:"absolute",left:0,top:0},width:a,height:o,onMouseMove:H,onMouseDown:T,onMouseUp:I,onMouseEnter:W,onMouseLeave:B,onWheel:L},"canvas-"+t)}))})},ie={},re=function(e,t){},ae=function(){return new Q((function(e,t,n){var i=t.sampledSlice,r=t.valueRange,a=t.width,o=t.height,c=t.component;if(i){var s=i.slice.nx,l=i.slice.ny,u=Math.min(a/s,o/l),h=i.components.indexOf(c||"")||0;if(e.wipe(),i){for(var d=e.createImageData(a,o),f=0;f<a;f++){var v=Math.round(f/u);if(0<v&&v<s)for(var x=0;x<o;x++){var b=Math.round(x/u);if(0<b&&b<l){var g=(i.data[v][b][h]-r.min)/(r.max-r.min),m=4*(f+a*x),p=oe(g);d.data[m+0]=p[0],d.data[m+1]=p[1],d.data[m+2]=p[2],d.data[m+3]=p[3]}}}e.putImageData(d,0,0)}}}),(function(e,t){e.scheduleRepaint()}),ie,{discreteMouseEventHandlers:[re],dragHandlers:[]})},oe=function(e){e<=0&&(e=0),e>=1&&(e=1);var t=Math.floor(255.999*e);return[t,t,t,255]},ce=function(e){e.width,e.height;var t=e.sampledSlice,n=e.component,r=e.valueRange,a=function(e){var t=Object(i.useState)([]),n=Object(u.a)(t,2),r=n[0],a=n[1];return function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}(r,e)?r:(a(e),e)}([function(e,t){var n=Object(i.useState)(null),r=Object(u.a)(n,2),a=r[0],o=r[1];return Object(i.useEffect)((function(){null===a&&o(e())}),[a,o,e]),a&&t&&a.setProps(t),a}(ae,{width:300,height:300,sampledSlice:t,valueRange:r,component:n})]);return Object(c.jsx)(ne,{layers:a,width:300,height:300})},se=n(195);function le(e){return"Slice ".concat(e)}var ue=function(e){var t=e.width,n=e.numSlices,r=e.currentSlice,a=e.onCurrentSliceChanged,o=Object(i.useCallback)((function(e,t){a(t)}),[a]);return Object(c.jsx)("div",{style:{width:t},children:Object(c.jsx)(se.a,{value:r,onChange:o,getAriaValueText:le,valueLabelDisplay:"auto",step:1,marks:!0,min:0,max:n-1})})};var he=function(e){var t=e.components,n=e.currentComponent,i=e.onCurrentComponentChanged;return Object(c.jsx)("div",{children:Object(c.jsx)(O,{label:"",value:n||"",onSetValue:i,options:t.map((function(e){return{label:e,value:e,disabled:!1}}))})})};function de(e){return"Brightness ".concat(e)}var fe=function(e){var t=e.brightness,n=e.onBrightnessChanged,r=e.width,a=Object(i.useCallback)((function(e,t){n(t)}),[n]);return Object(c.jsx)("div",{style:{width:r},children:Object(c.jsx)(se.a,{value:t,onChange:a,getAriaValueText:de,valueLabelDisplay:"auto",step:1,marks:!0,min:0,max:100})})},ve=function(e){var t=e.sampledSlices,n=Object(i.useState)(void 0),r=Object(u.a)(n,2),a=r[0],o=r[1],s=t?t.length:0,l=Object(i.useMemo)((function(){return{N1:t?t[0].data.length:0,N2:t?t[0].data[0].length:0}}),[t]),h=l.N1,d=l.N2,f=Object(i.useMemo)((function(){var e,n={min:0,max:0},i=!0,r=Object(D.a)(t||[]);try{for(r.s();!(e=r.n()).done;)for(var a=e.value,o=0;o<a.data.length;o++)for(var c=0;c<a.data[o].length;c++)for(var s=0;s<a.data[o][c].length;s++){var l=a.data[o][c][s];n.min=i?l:Math.min(n.min,l),n.max=i?l:Math.max(n.max,l),i=!1}}catch(u){r.e(u)}finally{r.f()}return n}),[t]),v=Object(i.useState)(void 0),x=Object(u.a)(v,2),b=x[0],g=x[1],m=Object(i.useState)(50),p=Object(u.a)(m,2),j=p[0],y=p[1],O=t?Math.floor(t.length/2):0,_=t?t[a||O].components[0]:"",k=Object(i.useMemo)((function(){var e=Math.exp((j-50)/50*4);return{min:f.min/e,max:f.max/e}}),[f,j]);return Object(c.jsxs)("div",{style:{margin:30},children:[Object(c.jsx)(ce,{width:300,height:300,sampledSlice:t?t[a||O]:void 0,component:b||_,valueRange:k}),Object(c.jsx)(ue,{width:300,numSlices:s,currentSlice:a||O,onCurrentSliceChanged:o}),Object(c.jsx)(he,{components:t?t[a||O].components:[],currentComponent:b,onCurrentComponentChanged:g}),Object(c.jsx)(fe,{width:300,brightness:j,onBrightnessChanged:y}),Object(c.jsx)("div",{children:t?Object(c.jsxs)("pre",{children:[null===t||void 0===t?void 0:t.length," sampled slices (",h," x ",d,")",Object(c.jsx)("br",{}),"Current slice index: ",a,Object(c.jsx)("br",{}),t[a||O].data.length]}):Object(c.jsx)("span",{})})]})},xe=function(e){var t=e.fieldModel,n=Object(i.useMemo)((function(){return[-.1,0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1,1.1].map((function(e){return function(e){var t=e.center,n=e.dx,i=e.dy,r=e.nx,a=e.ny;return{transformation:[[n[0],i[0],0,t[0]-.5*r*n[0]-.5*a*i[0]],[n[1],i[1],0,t[1]-.5*r*n[1]-.5*a*i[1]],[n[2],i[2],0,t[2]-.5*r*n[2]-.5*a*i[2]]],nx:r,ny:a}}({center:[.5,.5,e],dx:[.01,0,0],dy:[0,.01,0],nx:150,ny:150})}))}),[]),r=Object(i.useState)("real"),a=Object(u.a)(r,2),o=a[0],s=a[1],l=m(t,n,t.components,o);return Object(c.jsxs)("div",{children:[Object(c.jsx)(ve,{sampledSlices:l}),Object(c.jsx)(w,{currentMode:o,onCurrentModeChanged:s})]})},be=function(e){var t=e.fieldModel,n=e.workspaceRouteDispatch,r=Object(i.useCallback)((function(){n({type:"gotoFieldModelsPage"})}),[n]);if(!t)return Object(c.jsx)("div",{children:"No field model"});var o=t.dataShape;return Object(c.jsxs)("div",{children:[Object(c.jsx)(a.a,{onClick:r,children:"Back to field models"}),Object(c.jsxs)("div",{children:[Object(c.jsxs)("h3",{children:["Field model: ",t.fieldModelId," (",t.fieldModelLabel,")"]}),Object(c.jsx)("h4",{children:Object(c.jsxs)("pre",{children:["Data shape: ",o[1]," x ",o[2]," x ",o[3]]})}),Object(c.jsx)("h4",{children:Object(c.jsxs)("pre",{children:["Data uri: ",t.dataUri]})})]}),Object(c.jsx)(xe,{fieldModel:t})]})},ge=function(e){var t=e.workspace,n=e.workspaceDispatch,r=e.workspaceRoute,a=e.workspaceRouteDispatch,o=(e.width,e.height,Object(i.useCallback)((function(e){n({type:"deleteFieldModels",fieldModelIds:e})}),[n])),s=Object(i.useCallback)((function(e){a({type:"gotoFieldModelPage",fieldModelId:e})}),[a]);switch(r.page){case"fieldModels":return Object(c.jsx)(l,{fieldModels:t.fieldModels,onFieldModelClicked:s,onDeleteFieldModels:o});case"fieldModel":return Object(c.jsx)(be,{fieldModel:t.fieldModels.filter((function(e){return e.fieldModelId===r.fieldModelId}))[0],workspaceRouteDispatch:a})}};function me(e){e.registerPlugin({type:"WorkspaceView",name:"WorkspaceView",label:"Workspace View",component:ge})}}}]);
//# sourceMappingURL=6.53f18bf6.chunk.js.map