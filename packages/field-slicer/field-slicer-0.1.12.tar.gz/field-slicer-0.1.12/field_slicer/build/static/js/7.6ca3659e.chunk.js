(this["webpackJsonpfield-slicer"]=this["webpackJsonpfield-slicer"]||[]).push([[7],{111:function(e,t,n){"use strict";n(0);var c=n(11);t.a=function(e){var t=e.color,n=e.onClick,o=e.children,i={color:t||"gray",cursor:"pointer",textDecoration:"underline"};return Object(c.jsx)("span",{style:i,onClick:n,children:o})}},123:function(e,t,n){"use strict";var c=n(8),o=n(177),i=n(178),s=n(180),r=n(181),a=n(179),l=n(193),u=n(173),j=n(182),b=n(183),d=n(0),O=(n(124),n(11)),h=function(e){var t=e.title,n=e.rowKey,c=e.onDeleteRow,o=Object(d.useCallback)((function(){c&&c(n)}),[c,n]);return Object(O.jsx)(u.a,{title:t,onClick:o,children:Object(O.jsx)(j.a,{})})},p=function(e){var t=e.title,n=e.rowKey,c=e.onConfirmDeleteRow,o=Object(d.useCallback)((function(){c&&c(n,!0)}),[c,n]),i=Object(d.useCallback)((function(){c&&c(n,!1)}),[c,n]);return Object(O.jsxs)("span",{children:["Confirm delete?",Object(O.jsx)(u.a,{title:t,onClick:o,children:Object(O.jsx)(j.a,{})}),Object(O.jsx)(u.a,{title:"Cancel",onClick:i,children:"\u2716"})]})},f=function(e){var t=e.title,n=e.rowKey,c=e.onEditRow;return Object(O.jsx)(u.a,{title:t,onClick:function(){return c&&c(n)},children:Object(O.jsx)(b.a,{})})},x=function(e){return 0==e?e:e?"object"==typeof e?e.element?e.element:e.text||"":e:""};t.a=function(e){var t=e.rows,n=e.columns,u=e.onDeleteRow,j=void 0===u?void 0:u,b=e.deleteRowLabel,g=void 0===b?void 0:b,k=e.onEditRow,m=void 0===k?void 0:k,w=e.editRowLabel,v=void 0===w?void 0:w,C=e.selectionMode,y=void 0===C?"none":C,S=e.selectedRowKeys,D=void 0===S?{}:S,J=e.onSelectedRowKeysChanged,M=void 0===J?void 0:J,R=Object(d.useMemo)((function(){var e={};return Object.keys(D).forEach((function(t){e[t]=D[t]})),e}),[D]),I=Object(d.useState)(null),F=Object(c.a)(I,2),E=F[0],N=F[1],W=Object(d.useCallback)((function(e){M&&("single"===y?e in R&&R[e]?M([]):M([e+""]):"multiple"===y&&M(Object.keys(R).filter((function(t){return t!=e&&R[t]})).concat(R[e]?[]:[e.toString()])))}),[M,y,R]),K=Object(d.useCallback)((function(e){N(e)}),[]),L=Object(d.useCallback)((function(e,t){t&&j&&j(e),N(null)}),[j]),z=Object(d.useCallback)((function(e){m&&m(e)}),[m]);return Object(O.jsxs)(o.a,{className:"NiceTable",children:[Object(O.jsx)(i.a,{children:Object(O.jsxs)(s.a,{children:[Object(O.jsx)(r.a,{style:{width:0}},"_first"),n.map((function(e){return Object(O.jsx)(r.a,{children:Object(O.jsx)("span",{children:e.label})},e.key)}))]})}),Object(O.jsx)(a.a,{children:t.map((function(e){return Object(O.jsxs)(s.a,{children:[Object(O.jsxs)(r.a,{children:[j&&(E===e.key?Object(O.jsx)(p,{title:g||"",onConfirmDeleteRow:L,rowKey:e.key}):Object(O.jsx)(h,{title:g||"",onDeleteRow:K,rowKey:e.key})),m&&Object(O.jsx)(f,{title:v||"",onEditRow:z,rowKey:e.key}),"none"!==y&&Object(O.jsx)(l.a,{checked:R[e.key]||!1,onClick:function(){return W(e.key)}})]}),n.map((function(t){return Object(O.jsx)(r.a,{children:Object(O.jsx)("span",{children:x(e.columnValues[t.key])})},t.key)}))]},e.key)}))})]})}},124:function(e,t,n){},190:function(e,t,n){"use strict";n.r(t),n.d(t,"activate",(function(){return A}));var c=n(8),o=n(191),i=n(0),s=n(54),r=n(196),a=n(175),l=n(13),u=n(111),j=n(11),b=function(){var e=Object(i.useState)([]),t=Object(c.a)(e,2),n=t[0],o=t[1],s=Object(i.useContext)(l.a);return Object(i.useEffect)((function(){var e=setInterval((function(){var e=s.getHitherJobs();o(e)}),1e3);return function(){clearInterval(e)}}),[s]),{pendingJobs:n.filter((function(e){return"pending"===e.status})),runningJobs:n.filter((function(e){return"running"===e.status})),finishedJobs:n.filter((function(e){return"finished"===e.status})),erroredJobs:n.filter((function(e){return"error"===e.status})),allJobs:n}},d=function(e){var t=e.onClick,n=b(),c=n.pendingJobs,o=n.runningJobs,i=n.finishedJobs,s=n.erroredJobs,r=c.length,a=o.length,l=i.length,d=s.length,O="Jobs: ".concat(r," pending | ").concat(a," running | ").concat(l," finished | ").concat(d," errored"),h=d>0?Object(j.jsxs)("span",{children:[":",Object(j.jsx)("span",{style:{color:"pink"},children:d})]}):Object(j.jsx)("span",{});return Object(j.jsx)(u.a,{onClick:t,color:"white",children:Object(j.jsxs)("span",{title:O,style:{fontFamily:"courier"},children:[r,":",a,":",l,h]})})},O=n(173),h=n(169),p=n(171),f=n(172),x=function(e){var t=e.color,n=Object(i.useContext)(l.c),c=n.websocketStatus,o=n.onReconnectWebsocket,s=Object(i.useMemo)((function(){switch(c){case"waiting":return{icon:Object(j.jsx)(h.a,{style:{color:"blue"}}),title:"Loading..."};case"connected":return{icon:Object(j.jsx)(p.a,{style:{color:t}}),title:"Connected"};case"disconnected":return{icon:Object(j.jsx)(f.a,{style:{color:"red"}}),title:"Disconnected from server. Click to attempt reconnect."};default:throw Error("Unexpected.")}}),[c,t]),r=s.icon,a=s.title,u=Object(i.useCallback)((function(){"disconnected"===c&&o()}),[c,o]);return Object(j.jsx)(O.a,{title:a,onClick:u,children:r})},g=n(174),k=function(e){var t=e.onOpenSettings,n=e.color,c=Object(i.useMemo)((function(){return{icon:Object(j.jsx)(g.a,{}),title:"Open settings"}}),[]),o=c.icon,s=c.title,r=Object(i.useCallback)((function(){t()}),[t]);return Object(j.jsx)(O.a,{style:{color:n},title:s,onClick:r,children:o})},m={paddingBottom:0,color:"white",fontFamily:"sans-serif",fontWeight:"bold",cursor:"pointer"},w=function(e){var t=e.onOpenSettings,n=e.onOpenJobMonitor,c=e.workspaceRouteDispatch,o=e.logo,s=Object(i.useCallback)((function(){c({type:"gotoFieldModelsPage"})}),[c]);return Object(j.jsx)(r.a,{position:"static",style:{height:50,color:"white"},children:Object(j.jsxs)(a.a,{children:[o&&Object(j.jsx)("img",{src:o,className:"App-logo",alt:"logo",height:30,style:{paddingBottom:5,cursor:"pointer"},onClick:s}),"\xa0\xa0\xa0",Object(j.jsx)("div",{style:m,onClick:s,children:"Labbox Ephys"}),Object(j.jsx)("span",{style:{marginLeft:"auto"}}),Object(j.jsxs)("span",{style:{paddingBottom:0,color:"white"},children:[Object(j.jsx)(k,{onOpenSettings:t,color:"white"}),Object(j.jsx)(x,{color:"white"}),Object(j.jsx)(d,{onClick:n})]})]})})},v=n(184),C=n(176),y=n(177),S=n(178),D=n(179),J=n(180),M=n(181),R=function(e){var t=e.job,n=t.kwargs&&I(t.kwargs).length>50,o=t.kwargs&&I(t.kwargs).length>1e3,s=Object(i.useState)(!n),r=Object(c.a)(s,2),a=r[0],l=r[1],u=t.result&&I(t.result).length>50,b=t.result&&I(t.result).length>1e3,d=Object(i.useState)(!u),O=Object(c.a)(d,2),h=O[0],p=O[1],f=a?Object(j.jsxs)("div",{children:[n&&Object(j.jsx)(C.a,{onClick:function(){return l(!1)},children:"Collapse"}),Object(j.jsx)("pre",{children:t.kwargs?I(t.kwargs):""})]}):o?Object(j.jsx)(C.a,{onClick:function(){console.info(t.kwargs)},title:"Write input argumetns to the browser developer tools console",children:"Write input arguments to console"}):Object(j.jsx)(C.a,{onClick:function(){console.info(t.kwargs),l(!0)},children:"Expand"}),x=h?Object(j.jsxs)("div",{children:[u&&Object(j.jsx)(C.a,{onClick:function(){return p(!1)},children:"Collapse"}),Object(j.jsx)("pre",{children:t.result?I(t.result):""})]}):b?Object(j.jsx)(C.a,{onClick:function(){console.info(t.result)},title:"Write result to the browser developer tools console",children:"Write result to console"}):Object(j.jsx)(C.a,{onClick:function(){console.info(t.result),p(!0)},children:"Expand"}),g=[{label:"Job ID",value:t.jobId},{label:"Function name",value:t.functionName},{label:"Input arguments",value:f},{label:"Status",value:t.status},{label:"Started",value:t.timestampStarted?F(new Date(t.timestampStarted)):""},{label:"Finished",value:t.timestampFinished?F(new Date(t.timestampFinished)):""},{label:"Result",value:x},{label:"Error message",value:t.error_message}];return Object(j.jsx)("div",{children:Object(j.jsxs)(y.a,{className:"NiceTable",children:[Object(j.jsx)(S.a,{}),Object(j.jsx)(D.a,{children:g.map((function(e){return Object(j.jsxs)(J.a,{children:[Object(j.jsx)(M.a,{children:e.label}),Object(j.jsx)(M.a,{children:e.value})]},e.label)}))})]})})};function I(e){return JSON.stringify(e,null,4)}function F(e){var t,n,c="";return t=e,n=new Date,(t.getFullYear()!==n.getFullYear()||t.getMonth()!==n.getMonth()||t.getDate()!==n.getDate())&&(c+="".concat(e.getMonth()+1,"/").concat(e.getDate(),"/").concat(e.getFullYear(),"} ")),c+="".concat(e.toLocaleTimeString())}var E=function(e){var t=e.job,n=e.onBack;return Object(j.jsxs)("div",{children:[Object(j.jsx)("p",{children:Object(j.jsx)(u.a,{onClick:n,children:"Back to jobs"})}),Object(j.jsx)(R,{job:t})]})},N=n(19),W=n(123),K=n(182);function L(e){var t,n,c="";return t=e,n=new Date,(t.getFullYear()!==n.getFullYear()||t.getMonth()!==n.getMonth()||t.getDate()!==n.getDate())&&(c+="".concat(e.getMonth()+1,"/").concat(e.getDate(),"/").concat(e.getFullYear(),"} ")),c+="".concat(e.toLocaleTimeString())}var z=function(e){var t=e.onClick;return Object(j.jsx)(O.a,{title:"Cancel job",onClick:t,children:Object(j.jsx)(K.a,{})})},B=function(e){var t=e.jobs,n=e.onViewJob,c=e.onCancelJob,o=Object(i.useMemo)((function(){return[{key:"jobId",label:"Job"},{key:"functionName",label:"Function"},{key:"status",label:"Status"},{key:"started",label:"Started"},{key:"finished",label:"Finished"},{key:"message",label:"Message"}]}),[]),s=Object(i.useMemo)((function(){return Object(N.a)(t).sort((function(e,t){return"running"===e.status&&"running"!==t.status?-1:"running"===t.status&&"running"!==e.status?1:e.timestampStarted&&t.timestampStarted?e.timestampStarted<t.timestampStarted?1:t.timestampStarted<e.timestampStarted?-1:0:0}))}),[t]),r=Object(i.useMemo)((function(){return s.map((function(e){return{key:e.jobId||"null",columnValues:{jobId:{text:e.jobId,element:Object(j.jsx)(u.a,{onClick:function(){n&&n(e)},children:e.jobId})},functionName:{text:e.functionName},status:{text:e.status,element:"running"===e.status?Object(j.jsxs)("span",{children:[Object(j.jsxs)("span",{children:[e.status," "]}),Object(j.jsx)(z,{onClick:function(){c&&c(e)}})]}):Object(j.jsx)("span",{children:e.status})},started:{text:e.timestampStarted?L(new Date(e.timestampStarted)):""},finished:{text:e.timestampFinished?L(new Date(e.timestampFinished)):""},message:{text:e.error_message||""}}}}))}),[s]);return Object(j.jsx)(W.a,{rows:r,columns:o})},U=Object(v.a)((function(e){return{paper:{left:100,top:100,right:100,bottom:100,position:"absolute",backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3),overflow:"auto"}}})),Y=function(){var e=U(),t=b().allJobs,n=Object(i.useState)(null),o=Object(c.a)(n,2),s=o[0],r=o[1],a=Object(i.useCallback)((function(e){r(e)}),[]),l=Object(i.useCallback)((function(){}),[]),u=Object(i.useCallback)((function(){r(null)}),[]);return Object(j.jsxs)("div",{className:e.paper,style:{zIndex:9999},children:[Object(j.jsx)("h2",{children:"Job Monitor"}),s?Object(j.jsx)(E,{job:s,onBack:u}):Object(j.jsx)(B,{jobs:t,onViewJob:a,onCancelJob:l})]})},V=n(48),T=Object(v.a)((function(e){return{paper:{left:100,top:100,right:100,bottom:100,position:"absolute",backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3),overflow:"auto"}}})),_=function(e){var t=e.workspaceUri,n=e.version,c=T(),o=Object(i.useContext)(l.c).serverInfo,s=Object(V.a)(t).workspaceName;return Object(j.jsxs)("div",{className:c.paper,style:{zIndex:9999},children:[Object(j.jsxs)("h2",{children:["Field slicer ",n]}),Object(j.jsxs)(y.a,{children:[Object(j.jsxs)(J.a,{children:[Object(j.jsx)(M.a,{children:"Workspace URI"}),Object(j.jsx)(M.a,{children:t||""})]}),Object(j.jsxs)(J.a,{children:[Object(j.jsx)(M.a,{children:"Workspace name"}),Object(j.jsx)(M.a,{children:s})]}),Object(j.jsxs)(J.a,{children:[Object(j.jsx)(M.a,{children:"Kachery node ID"}),Object(j.jsx)(M.a,{children:o?o.nodeId:""})]}),Object(j.jsxs)(J.a,{children:[Object(j.jsx)(M.a,{children:"Default feed ID"}),Object(j.jsx)(M.a,{children:o?o.defaultFeedId:""})]})]})]})};function H(){var e=window;return{width:e.innerWidth,height:e.innerHeight}}var P=function(e){var t=e.workspace,n=e.workspaceDispatch,r=e.workspaceRoute,a=e.workspaceRouteDispatch,l=e.version,u=e.width,b=e.height,d=function(){var e=Object(i.useState)(H()),t=Object(c.a)(e,2),n=t[0],o=t[1];return Object(i.useEffect)((function(){function e(){o(H())}return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),n}(),O=d.width,h=d.height,p=(b||h)-72-2,f=(u||O)-0-2,x=Object(s.a)().filter((function(e){return"WorkspaceView"===e.name}))[0];if(!x)throw Error("Unable to find workspace view plugin");var g=Object(i.useState)(!1),k=Object(c.a)(g,2),m=k[0],v=k[1],C=Object(i.useState)(!1),y=Object(c.a)(C,2),S=y[0],D=y[1],J=Object(i.useCallback)((function(){v(!0)}),[]),M=Object(i.useCallback)((function(){D(!0)}),[]),R=Object(i.useCallback)((function(){v(!1)}),[]),I=Object(i.useCallback)((function(){D(!1)}),[]);return Object(j.jsxs)("div",{style:{margin:0},children:[Object(j.jsx)(w,{onOpenSettings:J,onOpenJobMonitor:M,workspaceRouteDispatch:a}),Object(j.jsx)("div",{style:{position:"absolute",top:72},children:Object(j.jsx)(x.component,{width:f,height:p,workspace:t,workspaceDispatch:n,workspaceRoute:r,workspaceRouteDispatch:a})}),Object(j.jsx)(o.a,{open:m,onClose:R,style:{zIndex:9999},children:Object(j.jsx)("span",{children:Object(j.jsx)(_,{workspace:t,workspaceUri:r.workspaceUri,version:l})})}),Object(j.jsx)(o.a,{open:S,onClose:I,style:{zIndex:9999},children:Object(j.jsx)("span",{children:Object(j.jsx)(Y,{})})})]})};function A(e){e.registerPlugin({type:"MainWindow",name:"MainWindow",label:"Main Window",component:P})}}}]);
//# sourceMappingURL=7.6ca3659e.chunk.js.map