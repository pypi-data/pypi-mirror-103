(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2eb605ce"],{"07ac":function(t,e,i){var a=i("23e7"),r=i("6f53").values;a({target:"Object",stat:!0},{values:function(t){return r(t)}})},"0afd":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cl-cluster"},[a("div",{staticClass:"cl-cluster-bk"},[a("div",{staticClass:"cl-cluster-title"},[a("div",{staticClass:"cl-cluster-title-left"},[t._v(t._s(t.$t("profilingCluster.titleText")))]),a("div",{staticClass:"path-message"},[a("span",[t._v(t._s(t.$t("symbols.leftbracket")))]),a("span",[t._v(t._s(t.$t("trainingDashboard.summaryDirPath")))]),a("span",[t._v(t._s(t.summaryPath))]),a("span",[t._v(t._s(t.$t("symbols.rightbracket")))])])]),a("div",{staticClass:"cl-step-filter"},[a("label",[t._v(t._s(t.stepTip))]),a("el-input",{staticClass:"step-input",attrs:{clearable:""},on:{clear:t.viewStepFilter},model:{value:t.step.showStep,callback:function(e){t.$set(t.step,"showStep",t._n(e))},expression:"step.showStep"}}),a("el-button",{on:{click:t.viewStepFilter}},[t._v(t._s(t.$t("public.sure")))])],1),a("div",{ref:"clusterChart",staticClass:"cl-cluster-chart"}),a("div",{staticClass:"cl-cluster-table"},[a("el-table",{ref:"table",attrs:{data:t.tableData,height:"100%",width:"100%",stripe:""},on:{"sort-change":t.tabeSortChange}},[a("el-table-column",{attrs:{width:"120",prop:"rank_id",label:t.$t("profilingCluster.rankID")}}),a("el-table-column",{attrs:{prop:"iteration_interval",sortable:"custom"}},[a("template",{slot:"header"},[a("span",{staticClass:"thSpan"},[t._v("|")]),a("span",{attrs:{title:t.$t("profiling.iterationGapTime")+"(ms)"}},[t._v(t._s(t.$t("profiling.iterationGapTime"))+"(ms)")])])],2),a("el-table-column",{attrs:{prop:"fp_and_bp",sortable:"custom"}},[a("template",{slot:"header"},[a("span",{staticClass:"thSpan"},[t._v("|")]),a("span",{attrs:{title:t.$t("profiling.fpBpTime")+"(ms)"}},[t._v(t._s(t.$t("profiling.fpBpTime"))+"(ms)")])])],2),a("el-table-column",{attrs:{prop:"tail",sortable:"custom"}},[a("template",{slot:"header"},[a("span",{staticClass:"thSpan"},[t._v("|")]),a("span",{attrs:{title:t.$t("profiling.tailTime")+"(ms)"}},[t._v(t._s(t.$t("profiling.tailTime"))+"(ms)")])])],2),a("el-table-column",{attrs:{fixed:"right",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){return t.viewProfilingDetail(e.row)}}},[t._v(t._s(t.$t("profiling.viewDetail")))])]}}])},[a("template",{slot:"header"},[a("span",{staticClass:"thSpan"},[t._v("|")]),t._v(t._s(t.$t("summaryManage.operation"))+" ")])],2)],1)],1),a("div",{staticClass:"cl-cluster-page"},[a("el-pagination",{attrs:{"page-sizes":t.pageSizes,"page-size":t.group_condition.limit,"current-page":t.group_condition.offset+1,layout:"total,sizes,prev,pager,next,jumper",total:t.totalCount},on:{"current-change":t.currentPageChange,"size-change":t.currentPageSizeChange}})],1)]),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.chartData.length,expression:"!chartData.length"}],staticClass:"no-data-img"},[a("div",[a("img",{attrs:{src:i("9485"),alt:""}}),a("p",[t._v(t._s(t.initOver?t.$t("public.noData"):t.$t("public.dataLoading")))])])])])},r=[],s=(i("99af"),i("07ac"),i("159b"),i("b0c0"),i("fb6a"),i("d3b7"),i("25f0"),i("ac1f"),i("5319"),i("313e")),n=i.n(s),o=i("3778"),l={data:function(){return{summaryPath:"",trainingJobId:this.$route.query.id,chartObj:null,chartData:[],chartOption:{color:["#6B92FA","#6CBFFF","#F6DF66"],tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{right:70,top:8,data:""},grid:{top:35,left:80,right:80},dataset:{},xAxis:{name:this.$t("profilingCluster.rankID"),nameTextStyle:{align:"left",padding:[0,5],color:"#9EA4B3"},type:"category",axisLine:{lineStyle:{color:"#E6EBF5",width:2}},axisLabel:{color:"#9EA4B3"}},yAxis:{name:this.$t("profilingCluster.timeTitle"),nameGap:20,nameTextStyle:{align:"right",padding:[0,5],color:"#9EA4B3"},axisLine:{lineStyle:{color:"#E6EBF5",width:2}},axisLabel:{color:"#9EA4B3"},splitLine:{lineStyle:{color:["#E6EBF5"],width:1,type:"dashed"}}},series:[{type:"bar",barWidth:8},{type:"bar",barWidth:8},{type:"bar",barWidth:8}],dataZoom:[]},chartResizeTimer:null,tableData:[],initOver:!1,pageSizes:[10,20,50],group_condition:{offset:0,limit:10},sort_condition:{name:"iteration_interval",type:"descending"},totalCount:0,step:{maxStep:"",filterStep:"",showStep:""},stepTip:this.$t("profiling.stepInputTip"),stepInfoCol:{iteration_interval:this.$t("profiling.iterationGapTime"),fp_and_bp:this.$t("profiling.fpBpTime"),tail:this.$t("profiling.tailTime")}}},mounted:function(){if(!this.trainingJobId)return this.$message.error(this.$t("trainingDashboard.invalidId")),document.title="".concat(this.$t("profilingCluster.clusterView"),"-MindInsight"),void(this.initOver=!0);this.summaryPath=decodeURIComponent(this.trainingJobId),document.title="".concat(this.summaryPath,"-").concat(this.$t("profilingCluster.clusterView"),"-MindInsight"),window.addEventListener("resize",this.resizeCallback,!1),this.chartOption.legend.data=Object.values(this.stepInfoCol),this.queryStepTraceInfo(!0,!0)},destroyed:function(){window.removeEventListener("resize",this.resizeCallback),this.chartResizeTimer&&(clearTimeout(this.chartResizeTimer),this.chartResizeTimer=null)},methods:{queryStepTraceInfo:function(t,e){var i=this,a={};a.params={train_id:this.trainingJobId},a.body={sort_condition:this.sort_condition,filter_condition:{}},t||(a.body.group_condition=this.group_condition),""!==this.step.filterStep&&(a.body.filter_condition={step_id:this.step.filterStep}),o["a"].getClusterInfo(a).then((function(a){if(a&&a.data&&a.data.step_trace&&a.data.step_trace.length){i.initOver=!0,i.step.maxStep=a.data.total_step_num,i.stepTip=i.$t("profiling.stepInputTip",{max:i.step.maxStep}),i.totalCount=a.data.size;var r=[];if(t&&(a.data.step_trace.forEach((function(t){var e=[t.rank_id].concat(t.step_trace_info);r.push(e)})),i.chartData=r,i.initChart()),e)i.$nextTick((function(){var t=i.$refs.table;t&&t.sort(i.sort_condition.name,i.sort_condition.type)}));else{var s=a.data.step_trace.slice(0,i.group_condition.limit);i.initTable(s)}}})).catch((function(t){i.initOver=!0,i.chartData=[],i.tableData=[]}))},initTable:function(t){var e=this;this.tableData=[],t.forEach((function(t){var i={};i.rank_id=t.rank_id,i.host_ip=t.host_ip,i.profiler_dir=t.profiler_dir,i.device_id=t.device_id;var a=t.step_trace_info;i.iteration_interval=a[0],i.fp_and_bp=a[1],i.tail=a[2],e.tableData.push(i)}))},initChart:function(){var t=this;this.chartOption.dataset={dimensions:["rankID"].concat(Object.values(this.stepInfoCol)),source:this.chartData};var e=this.chartData.length>25?25:this.chartData.length;this.chartOption.dataZoom=[{startValue:0,endValue:e},{startValue:0,endValue:e,type:"inside"}],this.$nextTick((function(){t.chartObj||(t.chartObj=n.a.init(t.$refs.clusterChart,null)),t.chartObj.setOption(t.chartOption,!0)}))},resizeCallback:function(){var t=this;this.chartResizeTimer&&(clearTimeout(this.chartResizeTimer),this.chartResizeTimer=null),this.chartResizeTimer=setTimeout((function(){t.chartObj&&t.chartObj.resize()}),200)},viewProfilingDetail:function(t){var e=this.$route.path.indexOf("profiling-gpu-cluster")>0?"/profiling-gpu":"/profiling",i=this.$router.resolve({path:e,query:{id:this.trainingJobId+"/cluster_profiler/"+t.host_ip,dir:t.profiler_dir,path:this.trainingJobId+"/cluster_profiler/"+t.host_ip,deviceid:t.device_id.toString()}});window.open(i.href,"_blank")},currentPageChange:function(t){this.group_condition.offset=t-1,this.queryStepTraceInfo(!1,!1)},currentPageSizeChange:function(t){this.group_condition.offset=0,this.group_condition.limit=t,this.queryStepTraceInfo(!1,!1)},tabeSortChange:function(t){this.sort_condition={name:t.prop,type:t.order},this.group_condition.offset=0,this.queryStepTraceInfo(!0,!1)},viewStepFilter:function(){/^[0-9]*[1-9][0-9]*$/.test(this.step.showStep)&&this.step.showStep<=this.step.maxStep?(this.step.filterStep=this.step.showStep,this.group_condition.offset=0,this.queryStepTraceInfo(!0,!1)):""===this.step.showStep?(this.step.filterStep="",this.group_condition.offset=0,this.queryStepTraceInfo(!0,!1)):(this.step.showStep=this.step.filterStep,this.$message.error(this.$t("profiling.inputError").replace("{max}",this.step.maxStep)))}}},c=l,p=(i("577e"),i("2877")),h=Object(p["a"])(c,a,r,!1,null,null,null);e["default"]=h.exports},"418a":function(t,e,i){},"577e":function(t,e,i){"use strict";i("418a")},"6f53":function(t,e,i){var a=i("83ab"),r=i("df75"),s=i("fc6a"),n=i("d1e7").f,o=function(t){return function(e){var i,o=s(e),l=r(o),c=l.length,p=0,h=[];while(c>p)i=l[p++],a&&!n.call(o,i)||h.push(t?[i,o[i]]:o[i]);return h}};t.exports={entries:o(!0),values:o(!1)}},9485:function(t,e,i){t.exports=i.p+"static/img/nodata.8290bed9.png"},b0c0:function(t,e,i){var a=i("83ab"),r=i("9bf2").f,s=Function.prototype,n=s.toString,o=/^\s*function ([^ (]*)/,l="name";a&&!(l in s)&&r(s,l,{configurable:!0,get:function(){try{return n.call(this).match(o)[1]}catch(t){return""}}})},fb6a:function(t,e,i){"use strict";var a=i("23e7"),r=i("861d"),s=i("e8b5"),n=i("23cb"),o=i("50c4"),l=i("fc6a"),c=i("8418"),p=i("b622"),h=i("1dde"),u=i("ae40"),d=h("slice"),f=u("slice",{ACCESSORS:!0,0:0,1:2}),g=p("species"),m=[].slice,_=Math.max;a({target:"Array",proto:!0,forced:!d||!f},{slice:function(t,e){var i,a,p,h=l(this),u=o(h.length),d=n(t,u),f=n(void 0===e?u:e,u);if(s(h)&&(i=h.constructor,"function"!=typeof i||i!==Array&&!s(i.prototype)?r(i)&&(i=i[g],null===i&&(i=void 0)):i=void 0,i===Array||void 0===i))return m.call(h,d,f);for(a=new(void 0===i?Array:i)(_(f-d,0)),p=0;d<f;d++,p++)d in h&&c(a,p,h[d]);return a.length=p,a}})}}]);